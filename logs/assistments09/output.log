
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
skill_min 0
# user: 3695
# skill: 148, 149
# question: 17727, 17728
# interaction: 282071
MODEL routerakt
<class 'data_loaders.MostRecentQuestionSkillDataset'>
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:60.75
mean of total set, question correct ratio:66.67
mean of total set, class 0 ratio:0.38
mean of total set, class 1 ratio:0.62
--------------------------------------------------------------------------------
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
# of train set, 2625
mean of train set, skill correct ratio:60.75
mean of train set, question correct ratio:66.86
mean of train set, class 0 ratio:0.37
mean of train set, class 1 ratio:0.63
--------------------------------------------------------------------------------
# of valid set, 290
mean of valid set, skill correct ratio:60.75
mean of valid set, question correct ratio:66.86
mean of valid set, class 0 ratio:0.37
mean of valid set, class 1 ratio:0.63
--------------------------------------------------------------------------------
# of test set, 729
mean of test set, skill correct ratio:60.75
mean of test set, question correct ratio:66.86
mean of test set, class 0 ratio:0.38
mean of test set, class 1 ratio:0.62
--------------------------------------------------------------------------------
train_ids 2660
valid_ids 296
test_ids 739
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0001
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.0
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic

 17%|█████████▊                                                 | 1/6 [00:01<00:09,  1.95s/it]
token_cnts 108819 label_sums 67978.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.01it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  2.23it/s]
token_cnts 217638 label_sums 135956.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.76it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.41it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 326457 label_sums 203934.0
Fold 0:	 Epoch 3	TRAIN LOSS: 0.6405	VALID AUC: 0.6572	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1602
token_cnts 435276 label_sums 271912.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.57it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.29it/s]
token_cnts 544095 label_sums 339890.0
Fold 0:	 Epoch 5	TRAIN LOSS: 0.6062	VALID AUC: 0.7169	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1179
token_cnts 652914 label_sums 407868.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.58it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.56it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.78it/s]
token_cnts 761733 label_sums 475846.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.09it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.58it/s]
token_cnts 870552 label_sums 543824.0
Fold 0:	 Epoch 8	TRAIN LOSS: 0.5862	VALID AUC: 0.7352	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0456
token_cnts 979371 label_sums 611802.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.20it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.52it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.05it/s]
token_cnts 1088190 label_sums 679780.0
Fold 0:	 Epoch 10	TRAIN LOSS: 0.5749	VALID AUC: 0.7417	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0403
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.38it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.49it/s]
Fold 0:	 Epoch 11	TRAIN LOSS: 0.5722	VALID AUC: 0.7442	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0404
token_cnts 1305828 label_sums 815736.0
Fold 0:	 Epoch 12	TRAIN LOSS: 0.5696	VALID AUC: 0.7482	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0508
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.66it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.44it/s]
token_cnts 1414647 label_sums 883714.0
Fold 0:	 Epoch 13	TRAIN LOSS: 0.5649	VALID AUC: 0.7501	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0440
token_cnts 1523466 label_sums 951692.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.74it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.76it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.20it/s]
token_cnts 1632285 label_sums 1019670.0
Fold 0:	 Epoch 15	TRAIN LOSS: 0.5594	VALID AUC: 0.7594	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0468
token_cnts 1741104 label_sums 1087648.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.75it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.45it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 1849923 label_sums 1155626.0
Fold 0:	 Epoch 17	TRAIN LOSS: 0.5479	VALID AUC: 0.7638	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0419
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.79it/s]
Fold 0:	 Epoch 18	TRAIN LOSS: 0.5467	VALID AUC: 0.7655	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0509
token_cnts 2067561 label_sums 1291582.0
Fold 0:	 Epoch 19	TRAIN LOSS: 0.5468	VALID AUC: 0.7719	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0499
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.80it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.55it/s]
token_cnts 2176380 label_sums 1359560.0
Fold 0:	 Epoch 20	TRAIN LOSS: 0.5356	VALID AUC: 0.7696	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0376
token_cnts 2285199 label_sums 1427538.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.78it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.80it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.19it/s]
token_cnts 2394018 label_sums 1495516.0
Fold 0:	 Epoch 22	TRAIN LOSS: 0.5485	VALID AUC: 0.7688	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0390
token_cnts 2502837 label_sums 1563494.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.94it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.85it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.26it/s]
token_cnts 2611656 label_sums 1631472.0
Fold 0:	 Epoch 24	TRAIN LOSS: 0.5243	VALID AUC: 0.7745	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0151
token_cnts 2720475 label_sums 1699450.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.70it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.22it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2829294 label_sums 1767428.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.47it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.46it/s]
token_cnts 2938113 label_sums 1835406.0
Fold 0:	 Epoch 27	TRAIN LOSS: 0.4958	VALID AUC: 0.7743	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9992
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.02it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.14it/s]
Fold 0:	 Epoch 28	TRAIN LOSS: 0.4880	VALID AUC: 0.7714	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0151
token_cnts 3155751 label_sums 1971362.0
Fold 0:	 Epoch 29	TRAIN LOSS: 0.4894	VALID AUC: 0.7733	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0148
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.43it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.42it/s]

100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.59it/s]
Fold 0:	 Epoch 30	TRAIN LOSS: 0.4785	VALID AUC: 0.7721	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0124

 50%|█████████████████████████████▌                             | 3/6 [00:04<00:03,  1.12s/it]
token_cnts 3373389 label_sums 2107318.0
Fold 0:	 Epoch 31	TRAIN LOSS: 0.4697	VALID AUC: 0.7670	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0238
token_cnts 3482208 label_sums 2175296.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:05<00:00,  1.18it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.71it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.28it/s]
token_cnts 3591027 label_sums 2243274.0
Fold 0:	 Epoch 33	TRAIN LOSS: 0.4699	VALID AUC: 0.7685	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0182
token_cnts 3699846 label_sums 2311252.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.98it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]

100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.87it/s]
[ORIGINAL] Best Model	TEST AUC: 0.7838	TEST ACC: 0.7270	TEST RMSE: 0.4373
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 18298.31
auc 0.7838 acc 0.7270 rmse 0.4373
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:60.75
mean of total set, question correct ratio:66.67
mean of total set, class 0 ratio:0.38
mean of total set, class 1 ratio:0.62
--------------------------------------------------------------------------------
# of train set, 2627
mean of train set, skill correct ratio:61.16
mean of train set, question correct ratio:67.07
mean of train set, class 0 ratio:0.37
mean of train set, class 1 ratio:0.63
--------------------------------------------------------------------------------
# of valid set, 289
mean of valid set, skill correct ratio:61.16
mean of valid set, question correct ratio:67.07
mean of valid set, class 0 ratio:0.40
mean of valid set, class 1 ratio:0.60
--------------------------------------------------------------------------------
# of test set, 728
mean of test set, skill correct ratio:61.16
mean of test set, question correct ratio:67.07
mean of test set, class 0 ratio:0.38
mean of test set, class 1 ratio:0.62
--------------------------------------------------------------------------------
train_ids 2660
valid_ids 296
test_ids 739
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0001
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.0
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.01it/s]
token_cnts 108199 label_sums 67985.0
Fold 1:	 Epoch 1	TRAIN LOSS: 0.7441	VALID AUC: 0.5996	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0792
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.68it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.93it/s]
Fold 1:	 Epoch 2	TRAIN LOSS: 0.6959	VALID AUC: 0.6233	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1014
token_cnts 324597 label_sums 203955.0
Fold 1:	 Epoch 3	TRAIN LOSS: 0.6476	VALID AUC: 0.6403	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0792
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.89it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.20it/s]
token_cnts 432796 label_sums 271940.0
Fold 1:	 Epoch 4	TRAIN LOSS: 0.6352	VALID AUC: 0.6880	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0771
token_cnts 540995 label_sums 339925.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.43it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.80it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  2.92it/s]
token_cnts 649194 label_sums 407910.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.28it/s]
 83%|█████████████████████████████████████████████████▏         | 5/6 [00:01<00:00,  4.63it/s]
token_cnts 757393 label_sums 475895.0
Fold 1:	 Epoch 7	TRAIN LOSS: 0.5866	VALID AUC: 0.7245	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0604
token_cnts 865592 label_sums 543880.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.59it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.12it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:02,  2.02it/s]
token_cnts 973791 label_sums 611865.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.11it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  3.92it/s]
token_cnts 1081990 label_sums 679850.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.08it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  3.89it/s]
token_cnts 1190189 label_sums 747835.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:05<00:00,  1.18it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 1298388 label_sums 815820.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.05it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.04it/s]
token_cnts 1406587 label_sums 883805.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.80it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.06it/s]
token_cnts 1514786 label_sums 951790.0
Fold 1:	 Epoch 14	TRAIN LOSS: 0.5573	VALID AUC: 0.7588	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0609
token_cnts 1622985 label_sums 1019775.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.64it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.61it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.20it/s]
token_cnts 1731184 label_sums 1087760.0
Fold 1:	 Epoch 16	TRAIN LOSS: 0.5548	VALID AUC: 0.7634	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0682
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.77it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.51it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
Fold 1:	 Epoch 17	TRAIN LOSS: 0.5505	VALID AUC: 0.7616	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0678
token_cnts 1947582 label_sums 1223730.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.34it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.12it/s]
token_cnts 2055781 label_sums 1291715.0
Fold 1:	 Epoch 19	TRAIN LOSS: 0.5361	VALID AUC: 0.7664	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0550
token_cnts 2163980 label_sums 1359700.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.36it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.77it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.21it/s]
token_cnts 2272179 label_sums 1427685.0
Fold 1:	 Epoch 21	TRAIN LOSS: 0.5398	VALID AUC: 0.7720	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0437
token_cnts 2380378 label_sums 1495670.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.78it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2488577 label_sums 1563655.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.70it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  4.13it/s]
token_cnts 2596776 label_sums 1631640.0
Fold 1:	 Epoch 24	TRAIN LOSS: 0.5123	VALID AUC: 0.7781	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0404
token_cnts 2704975 label_sums 1699625.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.08it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.77it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  2.65it/s]
token_cnts 2813174 label_sums 1767610.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.95it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.51it/s]
token_cnts 2921373 label_sums 1835595.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.94it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  3.92it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:04<00:00,  1.21it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
Fold 1:	 Epoch 28	TRAIN LOSS: 0.4850	VALID AUC: 0.7662	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0338
token_cnts 3137771 label_sums 1971565.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.11it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  2.82it/s]
token_cnts 3245970 label_sums 2039550.0
Fold 1:	 Epoch 30	TRAIN LOSS: 0.5048	VALID AUC: 0.7733	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0364
token_cnts 3354169 label_sums 2107535.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.79it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.37it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 3462368 label_sums 2175520.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.31it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.32it/s]
token_cnts 3570567 label_sums 2243505.0
Fold 1:	 Epoch 33	TRAIN LOSS: 0.4616	VALID AUC: 0.7672	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9924
token_cnts 3678766 label_sums 2311490.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.27it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.63it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.03it/s]
token_cnts 3786965 label_sums 2379475.0
Fold 1:	 Epoch 35	TRAIN LOSS: 0.4504	VALID AUC: 0.7721	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0167
token_cnts 3895164 label_sums 2447460.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.74it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.77it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.18it/s]
token_cnts 4003363 label_sums 2515445.0
[ORIGINAL] Best Model	TEST AUC: 0.7844	TEST ACC: 0.7174	TEST RMSE: 0.4387
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 18466.94

100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.61it/s]
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:60.75
mean of total set, question correct ratio:66.67
mean of total set, class 0 ratio:0.38
mean of total set, class 1 ratio:0.62
--------------------------------------------------------------------------------
# of train set, 2625
mean of train set, skill correct ratio:60.75
mean of train set, question correct ratio:66.79
mean of train set, class 0 ratio:0.38
mean of train set, class 1 ratio:0.62
--------------------------------------------------------------------------------
# of valid set, 292
mean of valid set, skill correct ratio:60.75
mean of valid set, question correct ratio:66.79
mean of valid set, class 0 ratio:0.37
mean of valid set, class 1 ratio:0.63
--------------------------------------------------------------------------------
# of test set, 727
mean of test set, skill correct ratio:60.75
mean of test set, question correct ratio:66.79
mean of test set, class 0 ratio:0.37
mean of test set, class 1 ratio:0.63
--------------------------------------------------------------------------------
train_ids 2660
valid_ids 296
test_ids 739
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0001
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.0
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.22it/s]
token_cnts 106314 label_sums 65976.0
Fold 2:	 Epoch 1	TRAIN LOSS: 0.7474	VALID AUC: 0.5802	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0504
token_cnts 212628 label_sums 131952.0
Fold 2:	 Epoch 2	TRAIN LOSS: 0.6943	VALID AUC: 0.5905	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0745
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.93it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  2.63it/s]
token_cnts 318942 label_sums 197928.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.77it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:01<00:00,  3.14it/s]
token_cnts 425256 label_sums 263904.0
Fold 2:	 Epoch 4	TRAIN LOSS: 0.6387	VALID AUC: 0.6794	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1409
token_cnts 531570 label_sums 329880.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.01it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.01it/s]


 50%|█████████████████████████████▌                             | 3/6 [00:03<00:04,  1.65s/it]
token_cnts 637884 label_sums 395856.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:04<00:00,  1.28it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  2.89it/s]
token_cnts 744198 label_sums 461832.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.63it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.73it/s]
token_cnts 850512 label_sums 527808.0
Fold 2:	 Epoch 8	TRAIN LOSS: 0.5867	VALID AUC: 0.7407	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1253
token_cnts 956826 label_sums 593784.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.84it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
Fold 2:	 Epoch 9	TRAIN LOSS: 0.5833	VALID AUC: 0.7446	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1128
token_cnts 1063140 label_sums 659760.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.64it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 1169454 label_sums 725736.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.71it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:02,  1.94it/s]
token_cnts 1275768 label_sums 791712.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.81it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:02,  1.91it/s]
token_cnts 1382082 label_sums 857688.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  2.52it/s]
token_cnts 1488396 label_sums 923664.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.70it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:01<00:01,  2.84it/s]
token_cnts 1594710 label_sums 989640.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.79it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  3.28it/s]
token_cnts 1701024 label_sums 1055616.0
Fold 2:	 Epoch 16	TRAIN LOSS: 0.5486	VALID AUC: 0.7717	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1065
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.13it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.93it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
Fold 2:	 Epoch 17	TRAIN LOSS: 0.5549	VALID AUC: 0.7766	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1081
token_cnts 1913652 label_sums 1187568.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.70it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2019966 label_sums 1253544.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.64it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.92it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.19it/s]
token_cnts 2126280 label_sums 1319520.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.39it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  3.49it/s]
token_cnts 2232594 label_sums 1385496.0
Fold 2:	 Epoch 21	TRAIN LOSS: 0.5306	VALID AUC: 0.7810	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0806
token_cnts 2338908 label_sums 1451472.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.35it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.52it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.86it/s]
token_cnts 2445222 label_sums 1517448.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.37it/s]
 83%|█████████████████████████████████████████████████▏         | 5/6 [00:01<00:00,  4.37it/s]
token_cnts 2551536 label_sums 1583424.0
Fold 2:	 Epoch 24	TRAIN LOSS: 0.5104	VALID AUC: 0.7868	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0871
token_cnts 2657850 label_sums 1649400.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.24it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.31it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.01it/s]
token_cnts 2764164 label_sums 1715376.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.29it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  4.06it/s]
token_cnts 2870478 label_sums 1781352.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.16it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.16it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  3.89it/s]
token_cnts 2976792 label_sums 1847328.0
Fold 2:	 Epoch 28	TRAIN LOSS: 0.4900	VALID AUC: 0.7854	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0894
token_cnts 3083106 label_sums 1913304.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.47it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.47it/s]
token_cnts 3189420 label_sums 1979280.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.47it/s]
Fold 2:	 Epoch 30	TRAIN LOSS: 0.4896	VALID AUC: 0.7815	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0725
token_cnts 3295734 label_sums 2045256.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.67it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.67it/s]
token_cnts 3402048 label_sums 2111232.0
Fold 2:	 Epoch 32	TRAIN LOSS: 0.4793	VALID AUC: 0.7806	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0828
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.50it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.50it/s]
Fold 2:	 Epoch 33	TRAIN LOSS: 0.4626	VALID AUC: 0.7809	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0695
token_cnts 3614676 label_sums 2243184.0
Fold 2:	 Epoch 34	TRAIN LOSS: 0.4540	VALID AUC: 0.7753	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0695
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.50it/s]
token_cnts 3720990 label_sums 2309160.0
[ORIGINAL] Best Model	TEST AUC: 0.7791	TEST ACC: 0.7232	TEST RMSE: 0.4352
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 14508.74
auc 0.7791 acc 0.7232 rmse 0.4352
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:60.75
mean of total set, question correct ratio:66.67
mean of total set, class 0 ratio:0.38
mean of total set, class 1 ratio:0.62
--------------------------------------------------------------------------------
# of train set, 2625
mean of train set, skill correct ratio:60.75
mean of train set, question correct ratio:66.82
mean of train set, class 0 ratio:0.38
mean of train set, class 1 ratio:0.62
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.65it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.65it/s]
# of valid set, 293
mean of valid set, skill correct ratio:60.75
mean of valid set, question correct ratio:66.82
mean of valid set, class 0 ratio:0.37
mean of valid set, class 1 ratio:0.63
--------------------------------------------------------------------------------
# of test set, 726
mean of test set, skill correct ratio:60.75
mean of test set, question correct ratio:66.82
mean of test set, class 0 ratio:0.37
mean of test set, class 1 ratio:0.63
--------------------------------------------------------------------------------
train_ids 2660
valid_ids 296
test_ids 739
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0001
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.0
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
token_cnts 107731 label_sums 67051.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.22it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.22it/s]
token_cnts 215462 label_sums 134102.0
Fold 3:	 Epoch 2	TRAIN LOSS: 0.6772	VALID AUC: 0.6362	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1135
token_cnts 323193 label_sums 201153.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 430924 label_sums 268204.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.14it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.14it/s]
token_cnts 538655 label_sums 335255.0
Fold 3:	 Epoch 5	TRAIN LOSS: 0.6128	VALID AUC: 0.7153	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0839
 33%|███████████████████▋                                       | 2/6 [00:01<00:03,  1.15it/s]
 33%|███████████████████▋                                       | 2/6 [00:01<00:03,  1.15it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:04<00:05,  1.91s/it]
 50%|█████████████████████████████▌                             | 3/6 [00:04<00:05,  1.91s/it]
token_cnts 754117 label_sums 469357.0
Fold 3:	 Epoch 7	TRAIN LOSS: 0.5953	VALID AUC: 0.7362	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0575
token_cnts 861848 label_sums 536408.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 969579 label_sums 603459.0
Fold 3:	 Epoch 9	TRAIN LOSS: 0.5820	VALID AUC: 0.7469	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0666
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.69it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.69it/s]
Fold 3:	 Epoch 10	TRAIN LOSS: 0.5721	VALID AUC: 0.7535	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0604
token_cnts 1185041 label_sums 737561.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.87it/s]
token_cnts 1292772 label_sums 804612.0
Fold 3:	 Epoch 12	TRAIN LOSS: 0.5704	VALID AUC: 0.7611	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0695
token_cnts 1400503 label_sums 871663.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.63it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.63it/s]
token_cnts 1508234 label_sums 938714.0
Fold 3:	 Epoch 14	TRAIN LOSS: 0.5610	VALID AUC: 0.7629	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0632
token_cnts 1615965 label_sums 1005765.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.69it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.69it/s]
token_cnts 1723696 label_sums 1072816.0
Fold 3:	 Epoch 16	TRAIN LOSS: 0.5576	VALID AUC: 0.7717	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0768
token_cnts 1831427 label_sums 1139867.0
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.68it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.68it/s]
token_cnts 1939158 label_sums 1206918.0
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.09it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.09it/s]
token_cnts 2046889 label_sums 1273969.0
Fold 3:	 Epoch 19	TRAIN LOSS: 0.5535	VALID AUC: 0.7800	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0747
token_cnts 2154620 label_sums 1341020.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.96it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.96it/s]
token_cnts 2262351 label_sums 1408071.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.15it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.15it/s]
token_cnts 2370082 label_sums 1475122.0
Fold 3:	 Epoch 22	TRAIN LOSS: 0.5387	VALID AUC: 0.7848	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0647
token_cnts 2477813 label_sums 1542173.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2585544 label_sums 1609224.0
 83%|█████████████████████████████████████████████████▏         | 5/6 [00:06<00:00,  1.45it/s]
 83%|█████████████████████████████████████████████████▏         | 5/6 [00:06<00:00,  1.45it/s]
token_cnts 2693275 label_sums 1676275.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2801006 label_sums 1743326.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.46it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.46it/s]
token_cnts 2908737 label_sums 1810377.0
Fold 3:	 Epoch 27	TRAIN LOSS: 0.4908	VALID AUC: 0.7870	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0521
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.72it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.72it/s]
Fold 3:	 Epoch 28	TRAIN LOSS: 0.4837	VALID AUC: 0.7857	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0567
token_cnts 3124199 label_sums 1944479.0
Fold 3:	 Epoch 29	TRAIN LOSS: 0.4749	VALID AUC: 0.7805	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0570
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.72it/s]
token_cnts 3231930 label_sums 2011530.0
Fold 3:	 Epoch 30	TRAIN LOSS: 0.4798	VALID AUC: 0.7878	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0504
token_cnts 3339661 label_sums 2078581.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.67it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.67it/s]
token_cnts 3447392 label_sums 2145632.0
Fold 3:	 Epoch 32	TRAIN LOSS: 0.4697	VALID AUC: 0.7763	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0627
token_cnts 3555123 label_sums 2212683.0
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.38it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.38it/s]
token_cnts 3662854 label_sums 2279734.0
Fold 3:	 Epoch 34	TRAIN LOSS: 0.4697	VALID AUC: 0.7810	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0480
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.05it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:00,  4.05it/s]
Fold 3:	 Epoch 35	TRAIN LOSS: 0.4628	VALID AUC: 0.7848	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0444
token_cnts 3878316 label_sums 2413836.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 3986047 label_sums 2480887.0
Fold 3:	 Epoch 37	TRAIN LOSS: 0.4380	VALID AUC: 0.7821	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0473
token_cnts 4093778 label_sums 2547938.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.99it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.99it/s]
token_cnts 4201509 label_sums 2614989.0
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  4.07it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  4.07it/s]
token_cnts 4309240 label_sums 2682040.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.92it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.92it/s]
token_cnts 4416971 label_sums 2749091.0
[ORIGINAL] Best Model	TEST AUC: 0.7730	TEST ACC: 0.7096	TEST RMSE: 0.4402
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
100%|███████████████████████████████████████████████████████████| 6/6 [00:02<00:00,  2.92it/s]
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 15214.29
auc 0.7730 acc 0.7096 rmse 0.4402
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:60.75
mean of total set, question correct ratio:66.67
mean of total set, class 0 ratio:0.38
mean of total set, class 1 ratio:0.62
--------------------------------------------------------------------------------
# of train set, 2616
mean of train set, skill correct ratio:61.16
mean of train set, question correct ratio:66.82
mean of train set, class 0 ratio:0.38
mean of train set, class 1 ratio:0.62
--------------------------------------------------------------------------------
# of valid set, 294
mean of valid set, skill correct ratio:61.16
mean of valid set, question correct ratio:66.82
mean of valid set, class 0 ratio:0.35
mean of valid set, class 1 ratio:0.65
--------------------------------------------------------------------------------
# of test set, 734
mean of test set, skill correct ratio:61.16
mean of test set, question correct ratio:66.82
mean of test set, class 0 ratio:0.38
mean of test set, class 1 ratio:0.62
--------------------------------------------------------------------------------
train_ids 2660
valid_ids 296
test_ids 739
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0001
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.0
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.88it/s]
token_cnts 106326 label_sums 66163.0
Fold 4:	 Epoch 1	TRAIN LOSS: 0.7444	VALID AUC: 0.5768	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1394
token_cnts 212652 label_sums 132326.0
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.71it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.71it/s]
token_cnts 318978 label_sums 198489.0
Fold 4:	 Epoch 3	TRAIN LOSS: 0.6450	VALID AUC: 0.6238	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1850
token_cnts 425304 label_sums 264652.0
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.51it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:00<00:00,  4.51it/s]
token_cnts 531630 label_sums 330815.0
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.23it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:01,  3.23it/s]
token_cnts 637956 label_sums 396978.0
Fold 4:	 Epoch 6	TRAIN LOSS: 0.6007	VALID AUC: 0.7126	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1932
token_cnts 744282 label_sums 463141.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 850608 label_sums 529304.0
Fold 4:	 Epoch 8	TRAIN LOSS: 0.5897	VALID AUC: 0.7224	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1722
token_cnts 956934 label_sums 595467.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  5.88it/s]
token_cnts 1063260 label_sums 661630.0
Fold 4:	 Epoch 10	TRAIN LOSS: 0.5717	VALID AUC: 0.7364	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1997
token_cnts 1169586 label_sums 727793.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.83it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.83it/s]
token_cnts 1275912 label_sums 793956.0
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.26it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:00<00:00,  4.26it/s]
token_cnts 1382238 label_sums 860119.0
Fold 4:	 Epoch 13	TRAIN LOSS: 0.5577	VALID AUC: 0.7509	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2026
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
Fold 4:	 Epoch 14	TRAIN LOSS: 0.5555	VALID AUC: 0.7573	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2000
token_cnts 1594890 label_sums 992445.0
 17%|█████████▊                                                 | 1/6 [00:00<00:03,  1.37it/s]
 33%|███████████████████▋                                       | 2/6 [00:04<00:09,  2.41s/it]
 33%|███████████████████▋                                       | 2/6 [00:04<00:09,  2.41s/it]
token_cnts 1701216 label_sums 1058608.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:05<00:00,  1.18it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:05<00:00,  1.18it/s]
token_cnts 1807542 label_sums 1124771.0
 50%|█████████████████████████████▌                             | 3/6 [00:01<00:01,  2.77it/s]
 50%|█████████████████████████████▌                             | 3/6 [00:01<00:01,  2.77it/s]
token_cnts 1913868 label_sums 1190934.0
Fold 4:	 Epoch 18	TRAIN LOSS: 0.5433	VALID AUC: 0.7722	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1727
token_cnts 2020194 label_sums 1257097.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.68it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.68it/s]
token_cnts 2126520 label_sums 1323260.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.82it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.82it/s]
token_cnts 2232846 label_sums 1389423.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2339172 label_sums 1455586.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.55it/s]
token_cnts 2445498 label_sums 1521749.0
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  2.62it/s]
 33%|███████████████████▋                                       | 2/6 [00:00<00:01,  2.62it/s]
token_cnts 2551824 label_sums 1587912.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.83it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.83it/s]
token_cnts 2658150 label_sums 1654075.0
Fold 4:	 Epoch 25	TRAIN LOSS: 0.4904	VALID AUC: 0.7793	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1237
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  3.33it/s]
 67%|███████████████████████████████████████▎                   | 4/6 [00:01<00:00,  3.33it/s]
Fold 4:	 Epoch 26	TRAIN LOSS: 0.4855	VALID AUC: 0.7759	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1203
token_cnts 2870802 label_sums 1786401.0
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
  0%|                                                                   | 0/6 [00:00<?, ?it/s]
token_cnts 2977128 label_sums 1852564.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.85it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.85it/s]
token_cnts 3083454 label_sums 1918727.0
 17%|█████████▊                                                 | 1/6 [00:00<00:02,  1.87it/s]
 17%|█████████▊                                                 | 1/6 [00:00<00:02,  1.87it/s]
token_cnts 3189780 label_sums 1984890.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  3.77it/s]
token_cnts 3296106 label_sums 2051053.0
Fold 4:	 Epoch 31	TRAIN LOSS: 0.4580	VALID AUC: 0.7760	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1407
token_cnts 3402432 label_sums 2117216.0
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.42it/s]
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.42it/s]
token_cnts 3508758 label_sums 2183379.0
[ORIGINAL] Best Model	TEST AUC: 0.7874	TEST ACC: 0.7347	TEST RMSE: 0.4228
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
100%|███████████████████████████████████████████████████████████| 6/6 [00:01<00:00,  4.42it/s]
[INFERENCE SPEED] Samples/second: 18385.30
auc 0.7874 acc 0.7347 rmse 0.4228
Average Inference Speed: 16974.72 samples/second (±1740.60)