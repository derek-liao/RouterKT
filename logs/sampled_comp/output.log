[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  3.36it/s]
skill_min 0
# user: 5000
# skill: 444, 445
# question: 7459, 7460
# interaction: 668927
MODEL routerakt
<class 'data_loaders.MostRecentQuestionSkillDataset'>
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:78.21
mean of total set, question correct ratio:75.33
mean of total set, class 0 ratio:0.20
mean of total set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:78.19
mean of train set, question correct ratio:75.47
mean of train set, class 0 ratio:0.20
mean of train set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:78.19
mean of valid set, question correct ratio:75.47
mean of valid set, class 0 ratio:0.19
mean of valid set, class 1 ratio:0.81
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:78.19
mean of test set, question correct ratio:75.47
mean of test set, class 0 ratio:0.20
mean of test set, class 1 ratio:0.80
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  4.98it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 226188 label_sums 180543.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 452376 label_sums 361086.0
Fold 0:	 Epoch 2	TRAIN LOSS: 0.4925	VALID AUC: 0.6330	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1452
token_cnts 678564 label_sums 541629.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
Fold 0:	 Epoch 3	TRAIN LOSS: 0.4801	VALID AUC: 0.6771	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1279
token_cnts 904752 label_sums 722172.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 1130940 label_sums 902715.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 1357128 label_sums 1083258.0
Fold 0:	 Epoch 6	TRAIN LOSS: 0.4493	VALID AUC: 0.7338	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0919
token_cnts 1583316 label_sums 1263801.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
token_cnts 1809504 label_sums 1444344.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 2035692 label_sums 1624887.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2261880 label_sums 1805430.0
Fold 0:	 Epoch 10	TRAIN LOSS: 0.4191	VALID AUC: 0.7809	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0558
token_cnts 2488068 label_sums 1985973.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
token_cnts 2714256 label_sums 2166516.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
token_cnts 2940444 label_sums 2347059.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 3166632 label_sums 2527602.0
Fold 0:	 Epoch 14	TRAIN LOSS: 0.3782	VALID AUC: 0.8173	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9756
token_cnts 3392820 label_sums 2708145.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 3619008 label_sums 2888688.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 3845196 label_sums 3069231.0
Fold 0:	 Epoch 17	TRAIN LOSS: 0.3650	VALID AUC: 0.8220	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9621
token_cnts 4071384 label_sums 3249774.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 4297572 label_sums 3430317.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
token_cnts 4523760 label_sums 3610860.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 4749948 label_sums 3791403.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 4976136 label_sums 3971946.0
Fold 0:	 Epoch 22	TRAIN LOSS: 0.3485	VALID AUC: 0.8262	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9613
token_cnts 5202324 label_sums 4152489.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
token_cnts 5428512 label_sums 4333032.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.99it/s]
token_cnts 5654700 label_sums 4513575.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 5880888 label_sums 4694118.0
Fold 0:	 Epoch 26	TRAIN LOSS: 0.3452	VALID AUC: 0.8263	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9505
token_cnts 6107076 label_sums 4874661.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 6333264 label_sums 5055204.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.36it/s]
token_cnts 6559452 label_sums 5235747.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 6785640 label_sums 5416290.0
Fold 0:	 Epoch 30	TRAIN LOSS: 0.3364	VALID AUC: 0.8300	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9388
token_cnts 7011828 label_sums 5596833.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 7238016 label_sums 5777376.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.44it/s]
token_cnts 7464204 label_sums 5957919.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.05it/s]
token_cnts 7690392 label_sums 6138462.0
Fold 0:	 Epoch 34	TRAIN LOSS: 0.3329	VALID AUC: 0.8305	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9355
token_cnts 7916580 label_sums 6319005.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 8142768 label_sums 6499548.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 8368956 label_sums 6680091.0
Fold 0:	 Epoch 37	TRAIN LOSS: 0.3284	VALID AUC: 0.8326	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9384
token_cnts 8595144 label_sums 6860634.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.06it/s]
Fold 0:	 Epoch 38	TRAIN LOSS: 0.3296	VALID AUC: 0.8333	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9444
token_cnts 8821332 label_sums 7041177.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 9047520 label_sums 7221720.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 9273708 label_sums 7402263.0
Fold 0:	 Epoch 41	TRAIN LOSS: 0.3238	VALID AUC: 0.8340	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9353
token_cnts 9499896 label_sums 7582806.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
token_cnts 9726084 label_sums 7763349.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 9952272 label_sums 7943892.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 10178460 label_sums 8124435.0
Fold 0:	 Epoch 45	TRAIN LOSS: 0.3206	VALID AUC: 0.8337	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9395
token_cnts 10404648 label_sums 8304978.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 10630836 label_sums 8485521.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 10857024 label_sums 8666064.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 11083212 label_sums 8846607.0
Fold 0:	 Epoch 49	TRAIN LOSS: 0.3243	VALID AUC: 0.8328	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9554
token_cnts 11309400 label_sums 9027150.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 11535588 label_sums 9207693.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 11761776 label_sums 9388236.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 11987964 label_sums 9568779.0
Fold 0:	 Epoch 53	TRAIN LOSS: 0.3162	VALID AUC: 0.8363	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9316
token_cnts 12214152 label_sums 9749322.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 12440340 label_sums 9929865.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
token_cnts 12666528 label_sums 10110408.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  3.98it/s]
token_cnts 12892716 label_sums 10290951.0
Fold 0:	 Epoch 57	TRAIN LOSS: 0.3184	VALID AUC: 0.8338	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9269
token_cnts 13118904 label_sums 10471494.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
token_cnts 13345092 label_sums 10652037.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 13571280 label_sums 10832580.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  3.94it/s]
token_cnts 13797468 label_sums 11013123.0
Fold 0:	 Epoch 61	TRAIN LOSS: 0.3073	VALID AUC: 0.8382	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9273
token_cnts 14023656 label_sums 11193666.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
token_cnts 14249844 label_sums 11374209.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 14476032 label_sums 11554752.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.05it/s]
token_cnts 14702220 label_sums 11735295.0
Fold 0:	 Epoch 65	TRAIN LOSS: 0.3264	VALID AUC: 0.8342	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9665
token_cnts 14928408 label_sums 11915838.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 15154596 label_sums 12096381.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 15380784 label_sums 12276924.0
Fold 0:	 Epoch 68	TRAIN LOSS: 0.3160	VALID AUC: 0.8333	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9093
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
token_cnts 15606972 label_sums 12457467.0
Fold 0:	 Epoch 69	TRAIN LOSS: 0.3134	VALID AUC: 0.8351	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9079
token_cnts 15833160 label_sums 12638010.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 16059348 label_sums 12818553.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 16285536 label_sums 12999096.0
Fold 0:	 Epoch 72	TRAIN LOSS: 0.3068	VALID AUC: 0.8372	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9107
token_cnts 16511724 label_sums 13179639.0
Fold 0:	 Epoch 73	TRAIN LOSS: 0.3059	VALID AUC: 0.8391	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9118
token_cnts 16737912 label_sums 13360182.0
Fold 0:	 Epoch 74	TRAIN LOSS: 0.3052	VALID AUC: 0.8358	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9070
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
token_cnts 16964100 label_sums 13540725.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
token_cnts 17190288 label_sums 13721268.0
Fold 0:	 Epoch 76	TRAIN LOSS: 0.3019	VALID AUC: 0.8397	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9128
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 0:	 Epoch 77	TRAIN LOSS: 0.3029	VALID AUC: 0.8389	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9094
token_cnts 17642664 label_sums 14082354.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
token_cnts 17868852 label_sums 14262897.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 18095040 label_sums 14443440.0
Fold 0:	 Epoch 80	TRAIN LOSS: 0.3144	VALID AUC: 0.8366	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9389
token_cnts 18321228 label_sums 14623983.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 18547416 label_sums 14804526.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
token_cnts 18773604 label_sums 14985069.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
token_cnts 18999792 label_sums 15165612.0
Fold 0:	 Epoch 84	TRAIN LOSS: 0.3012	VALID AUC: 0.8392	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9198
token_cnts 19225980 label_sums 15346155.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 19452168 label_sums 15526698.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.80it/s]
token_cnts 19678356 label_sums 15707241.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 19904544 label_sums 15887784.0
Fold 0:	 Epoch 88	TRAIN LOSS: 0.2947	VALID AUC: 0.8406	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9217
token_cnts 20130732 label_sums 16068327.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 20356920 label_sums 16248870.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
token_cnts 20583108 label_sums 16429413.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 20809296 label_sums 16609956.0
Fold 0:	 Epoch 92	TRAIN LOSS: 0.2892	VALID AUC: 0.8390	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9187
token_cnts 21035484 label_sums 16790499.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 21261672 label_sums 16971042.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 21487860 label_sums 17151585.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 21714048 label_sums 17332128.0
[ORIGINAL] Best Model	TEST AUC: 0.8312	TEST ACC: 0.8337	TEST RMSE: 0.3459
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10989.17
auc 0.8312 acc 0.8337 rmse 0.3459
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:78.21
mean of total set, question correct ratio:75.33

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
mean of total set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:78.50
mean of train set, question correct ratio:75.57
mean of train set, class 0 ratio:0.20
mean of train set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:78.50
mean of valid set, question correct ratio:75.57
mean of valid set, class 0 ratio:0.21
mean of valid set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:78.50
mean of test set, question correct ratio:75.57
mean of test set, class 0 ratio:0.20
mean of test set, class 1 ratio:0.80
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
token_cnts 226554 label_sums 181265.0
Fold 1:	 Epoch 1	TRAIN LOSS: 0.5635	VALID AUC: 0.5949	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1177
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.04it/s]
token_cnts 453108 label_sums 362530.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 679662 label_sums 543795.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 906216 label_sums 725060.0
Fold 1:	 Epoch 4	TRAIN LOSS: 0.4602	VALID AUC: 0.6917	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1107
token_cnts 1132770 label_sums 906325.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 1359324 label_sums 1087590.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 1585878 label_sums 1268855.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 1812432 label_sums 1450120.0
Fold 1:	 Epoch 8	TRAIN LOSS: 0.4334	VALID AUC: 0.7352	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0466
token_cnts 2038986 label_sums 1631385.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 2265540 label_sums 1812650.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 2492094 label_sums 1993915.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 2718648 label_sums 2175180.0
Fold 1:	 Epoch 12	TRAIN LOSS: 0.3882	VALID AUC: 0.7961	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0038
token_cnts 2945202 label_sums 2356445.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.59it/s]
token_cnts 3171756 label_sums 2537710.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 3398310 label_sums 2718975.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
token_cnts 3624864 label_sums 2900240.0
Fold 1:	 Epoch 16	TRAIN LOSS: 0.3609	VALID AUC: 0.8101	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0022
token_cnts 3851418 label_sums 3081505.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 4077972 label_sums 3262770.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 4304526 label_sums 3444035.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 4531080 label_sums 3625300.0
Fold 1:	 Epoch 20	TRAIN LOSS: 0.3536	VALID AUC: 0.8102	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0053
token_cnts 4757634 label_sums 3806565.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 4984188 label_sums 3987830.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 5210742 label_sums 4169095.0
Fold 1:	 Epoch 23	TRAIN LOSS: 0.3460	VALID AUC: 0.8126	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0009
token_cnts 5437296 label_sums 4350360.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
Fold 1:	 Epoch 24	TRAIN LOSS: 0.3424	VALID AUC: 0.8137	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9994
token_cnts 5663850 label_sums 4531625.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
token_cnts 5890404 label_sums 4712890.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 6116958 label_sums 4894155.0
Fold 1:	 Epoch 27	TRAIN LOSS: 0.3396	VALID AUC: 0.8112	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0034
token_cnts 6343512 label_sums 5075420.0
Fold 1:	 Epoch 28	TRAIN LOSS: 0.3388	VALID AUC: 0.8143	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0019
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 6570066 label_sums 5256685.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 6796620 label_sums 5437950.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 7023174 label_sums 5619215.0
Fold 1:	 Epoch 31	TRAIN LOSS: 0.3374	VALID AUC: 0.8149	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0005
token_cnts 7249728 label_sums 5800480.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
token_cnts 7476282 label_sums 5981745.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
token_cnts 7702836 label_sums 6163010.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
token_cnts 7929390 label_sums 6344275.0
Fold 1:	 Epoch 35	TRAIN LOSS: 0.3296	VALID AUC: 0.8117	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0114
token_cnts 8155944 label_sums 6525540.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 8382498 label_sums 6706805.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
token_cnts 8609052 label_sums 6888070.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
token_cnts 8835606 label_sums 7069335.0
Fold 1:	 Epoch 39	TRAIN LOSS: 0.3257	VALID AUC: 0.8139	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0070
token_cnts 9062160 label_sums 7250600.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 9288714 label_sums 7431865.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 9515268 label_sums 7613130.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 9741822 label_sums 7794395.0
Fold 1:	 Epoch 43	TRAIN LOSS: 0.3200	VALID AUC: 0.8179	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0094
token_cnts 9968376 label_sums 7975660.0
Fold 1:	 Epoch 44	TRAIN LOSS: 0.3194	VALID AUC: 0.8173	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0095
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 10194930 label_sums 8156925.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.37it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.37it/s]
token_cnts 10421484 label_sums 8338190.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.38it/s]
token_cnts 10648038 label_sums 8519455.0
Fold 1:	 Epoch 47	TRAIN LOSS: 0.3253	VALID AUC: 0.8175	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0042
token_cnts 10874592 label_sums 8700720.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 11101146 label_sums 8881985.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 11327700 label_sums 9063250.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 11554254 label_sums 9244515.0
Fold 1:	 Epoch 51	TRAIN LOSS: 0.3176	VALID AUC: 0.8177	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9997
token_cnts 11780808 label_sums 9425780.0
Fold 1:	 Epoch 52	TRAIN LOSS: 0.3176	VALID AUC: 0.8181	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0007
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 12007362 label_sums 9607045.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 12233916 label_sums 9788310.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 12460470 label_sums 9969575.0
Fold 1:	 Epoch 55	TRAIN LOSS: 0.3154	VALID AUC: 0.8178	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9982
token_cnts 12687024 label_sums 10150840.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
token_cnts 12913578 label_sums 10332105.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 13140132 label_sums 10513370.0
Fold 1:	 Epoch 58	TRAIN LOSS: 0.3098	VALID AUC: 0.8189	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9902
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 1:	 Epoch 59	TRAIN LOSS: 0.3087	VALID AUC: 0.8186	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9884
token_cnts 13593240 label_sums 10875900.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 13819794 label_sums 11057165.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 14046348 label_sums 11238430.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 14272902 label_sums 11419695.0
Fold 1:	 Epoch 63	TRAIN LOSS: 0.3062	VALID AUC: 0.8195	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9870
token_cnts 14499456 label_sums 11600960.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 14726010 label_sums 11782225.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 14952564 label_sums 11963490.0
Fold 1:	 Epoch 66	TRAIN LOSS: 0.3059	VALID AUC: 0.8199	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9860
token_cnts 15179118 label_sums 12144755.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 15405672 label_sums 12326020.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 15632226 label_sums 12507285.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 15858780 label_sums 12688550.0
Fold 1:	 Epoch 70	TRAIN LOSS: 0.2989	VALID AUC: 0.8209	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9805
token_cnts 16085334 label_sums 12869815.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.05it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.05it/s]
token_cnts 16311888 label_sums 13051080.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 16538442 label_sums 13232345.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
token_cnts 16764996 label_sums 13413610.0
Fold 1:	 Epoch 74	TRAIN LOSS: 0.2959	VALID AUC: 0.8194	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9784
token_cnts 16991550 label_sums 13594875.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.04it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.04it/s]
token_cnts 17218104 label_sums 13776140.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 17444658 label_sums 13957405.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.94it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.94it/s]
token_cnts 17671212 label_sums 14138670.0
Fold 1:	 Epoch 78	TRAIN LOSS: 0.2915	VALID AUC: 0.8209	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9726
token_cnts 17897766 label_sums 14319935.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.04it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.04it/s]
token_cnts 18124320 label_sums 14501200.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 18350874 label_sums 14682465.0
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.40it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.40it/s]
token_cnts 18577428 label_sums 14863730.0
Fold 1:	 Epoch 82	TRAIN LOSS: 0.2889	VALID AUC: 0.8230	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9695
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
Fold 1:	 Epoch 83	TRAIN LOSS: 0.2885	VALID AUC: 0.8214	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9715
token_cnts 19030536 label_sums 15226260.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 19257090 label_sums 15407525.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 19483644 label_sums 15588790.0
Fold 1:	 Epoch 86	TRAIN LOSS: 0.2860	VALID AUC: 0.8227	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9706
token_cnts 19710198 label_sums 15770055.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
token_cnts 19936752 label_sums 15951320.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 20163306 label_sums 16132585.0
Fold 1:	 Epoch 89	TRAIN LOSS: 0.2902	VALID AUC: 0.8214	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9697
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 20389860 label_sums 16313850.0
Fold 1:	 Epoch 90	TRAIN LOSS: 0.2944	VALID AUC: 0.8196	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9726
token_cnts 20616414 label_sums 16495115.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 20842968 label_sums 16676380.0
[ORIGINAL] Best Model	TEST AUC: 0.8285	TEST ACC: 0.8328	TEST RMSE: 0.3468
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10980.80
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:78.21
mean of total set, question correct ratio:75.33
mean of total set, class 0 ratio:0.20
mean of total set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:78.14
mean of train set, question correct ratio:75.72
mean of train set, class 0 ratio:0.20
mean of train set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:78.14
mean of valid set, question correct ratio:75.72
mean of valid set, class 0 ratio:0.20
mean of valid set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:78.14
mean of test set, question correct ratio:75.72
mean of test set, class 0 ratio:0.20
mean of test set, class 1 ratio:0.80
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 224815 label_sums 179771.0
Fold 2:	 Epoch 1	TRAIN LOSS: 0.5345	VALID AUC: 0.6326	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1240
token_cnts 449630 label_sums 359542.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 674445 label_sums 539313.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 899260 label_sums 719084.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 1124075 label_sums 898855.0
Fold 2:	 Epoch 5	TRAIN LOSS: 0.4516	VALID AUC: 0.7294	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1455
token_cnts 1348890 label_sums 1078626.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 1573705 label_sums 1258397.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 1798520 label_sums 1438168.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2023335 label_sums 1617939.0
Fold 2:	 Epoch 9	TRAIN LOSS: 0.4243	VALID AUC: 0.7670	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1169
token_cnts 2248150 label_sums 1797710.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 2472965 label_sums 1977481.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
token_cnts 2697780 label_sums 2157252.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2922595 label_sums 2337023.0
Fold 2:	 Epoch 13	TRAIN LOSS: 0.3779	VALID AUC: 0.8144	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0394
token_cnts 3147410 label_sums 2516794.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 3372225 label_sums 2696565.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.95it/s]
token_cnts 3597040 label_sums 2876336.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 3821855 label_sums 3056107.0
Fold 2:	 Epoch 17	TRAIN LOSS: 0.3572	VALID AUC: 0.8200	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0114
token_cnts 4046670 label_sums 3235878.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 4271485 label_sums 3415649.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 4496300 label_sums 3595420.0
Fold 2:	 Epoch 20	TRAIN LOSS: 0.3491	VALID AUC: 0.8207	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0032
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 2:	 Epoch 21	TRAIN LOSS: 0.3455	VALID AUC: 0.8210	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0014
token_cnts 4945930 label_sums 3954962.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 5170745 label_sums 4134733.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 5395560 label_sums 4314504.0
Fold 2:	 Epoch 24	TRAIN LOSS: 0.3404	VALID AUC: 0.8229	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9912
token_cnts 5620375 label_sums 4494275.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.05it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.05it/s]
token_cnts 5845190 label_sums 4674046.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
token_cnts 6070005 label_sums 4853817.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 6294820 label_sums 5033588.0
Fold 2:	 Epoch 28	TRAIN LOSS: 0.3351	VALID AUC: 0.8228	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9793
token_cnts 6519635 label_sums 5213359.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 6744450 label_sums 5393130.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 6969265 label_sums 5572901.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 7194080 label_sums 5752672.0
Fold 2:	 Epoch 32	TRAIN LOSS: 0.3299	VALID AUC: 0.8223	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9722
token_cnts 7418895 label_sums 5932443.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 7643710 label_sums 6112214.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 7868525 label_sums 6291985.0
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.43it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.43it/s]
token_cnts 8093340 label_sums 6471756.0
Fold 2:	 Epoch 36	TRAIN LOSS: 0.3258	VALID AUC: 0.8232	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9635
token_cnts 8318155 label_sums 6651527.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 8542970 label_sums 6831298.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 8767785 label_sums 7011069.0
Fold 2:	 Epoch 39	TRAIN LOSS: 0.3297	VALID AUC: 0.8199	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9589
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 8992600 label_sums 7190840.0
Fold 2:	 Epoch 40	TRAIN LOSS: 0.3299	VALID AUC: 0.8225	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9767
token_cnts 9217415 label_sums 7370611.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
token_cnts 9442230 label_sums 7550382.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 9667045 label_sums 7730153.0
Fold 2:	 Epoch 43	TRAIN LOSS: 0.3207	VALID AUC: 0.8241	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9594
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 9891860 label_sums 7909924.0
Fold 2:	 Epoch 44	TRAIN LOSS: 0.3199	VALID AUC: 0.8236	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9543
token_cnts 10116675 label_sums 8089695.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.50it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.50it/s]
token_cnts 10341490 label_sums 8269466.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
token_cnts 10566305 label_sums 8449237.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 10791120 label_sums 8629008.0
Fold 2:	 Epoch 48	TRAIN LOSS: 0.3143	VALID AUC: 0.8253	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9524
token_cnts 11015935 label_sums 8808779.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
token_cnts 11240750 label_sums 8988550.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 11465565 label_sums 9168321.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 11690380 label_sums 9348092.0
Fold 2:	 Epoch 52	TRAIN LOSS: 0.3115	VALID AUC: 0.8244	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9515
token_cnts 11915195 label_sums 9527863.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
token_cnts 12140010 label_sums 9707634.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 12364825 label_sums 9887405.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 12589640 label_sums 10067176.0
Fold 2:	 Epoch 56	TRAIN LOSS: 0.3140	VALID AUC: 0.8212	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9617
token_cnts 12814455 label_sums 10246947.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 13039270 label_sums 10426718.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 13264085 label_sums 10606489.0
Fold 2:	 Epoch 59	TRAIN LOSS: 0.3085	VALID AUC: 0.8262	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9512
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
Fold 2:	 Epoch 60	TRAIN LOSS: 0.3065	VALID AUC: 0.8263	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9429
token_cnts 13713715 label_sums 10966031.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 13938530 label_sums 11145802.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 14163345 label_sums 11325573.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
token_cnts 14388160 label_sums 11505344.0
Fold 2:	 Epoch 64	TRAIN LOSS: 0.3009	VALID AUC: 0.8275	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9388
token_cnts 14612975 label_sums 11685115.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 14837790 label_sums 11864886.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 15062605 label_sums 12044657.0
Fold 2:	 Epoch 67	TRAIN LOSS: 0.2984	VALID AUC: 0.8285	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9422
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
Fold 2:	 Epoch 68	TRAIN LOSS: 0.2974	VALID AUC: 0.8303	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9445
token_cnts 15512235 label_sums 12404199.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 15737050 label_sums 12583970.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 15961865 label_sums 12763741.0
Fold 2:	 Epoch 71	TRAIN LOSS: 0.3029	VALID AUC: 0.8287	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9531
token_cnts 16186680 label_sums 12943512.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 16411495 label_sums 13123283.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 16636310 label_sums 13303054.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 16861125 label_sums 13482825.0
Fold 2:	 Epoch 75	TRAIN LOSS: 0.2956	VALID AUC: 0.8300	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9466
token_cnts 17085940 label_sums 13662596.0
Fold 2:	 Epoch 76	TRAIN LOSS: 0.2919	VALID AUC: 0.8304	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9408
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 17310755 label_sums 13842367.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 17535570 label_sums 14022138.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 17760385 label_sums 14201909.0
Fold 2:	 Epoch 79	TRAIN LOSS: 0.2871	VALID AUC: 0.8313	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9385
token_cnts 17985200 label_sums 14381680.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 18210015 label_sums 14561451.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 18434830 label_sums 14741222.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 18659645 label_sums 14920993.0
Fold 2:	 Epoch 83	TRAIN LOSS: 0.2847	VALID AUC: 0.8332	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9450
token_cnts 18884460 label_sums 15100764.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 19109275 label_sums 15280535.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 19334090 label_sums 15460306.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 19558905 label_sums 15640077.0
Fold 2:	 Epoch 87	TRAIN LOSS: 0.2814	VALID AUC: 0.8341	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9440
token_cnts 19783720 label_sums 15819848.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 20008535 label_sums 15999619.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 20233350 label_sums 16179390.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 20458165 label_sums 16359161.0
Fold 2:	 Epoch 91	TRAIN LOSS: 0.2871	VALID AUC: 0.8335	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9460
token_cnts 20682980 label_sums 16538932.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 20907795 label_sums 16718703.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.36it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.36it/s]
token_cnts 21132610 label_sums 16898474.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 21357425 label_sums 17078245.0
Fold 2:	 Epoch 95	TRAIN LOSS: 0.2767	VALID AUC: 0.8356	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9478
token_cnts 21582240 label_sums 17258016.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 21807055 label_sums 17437787.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 22031870 label_sums 17617558.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 22256685 label_sums 17797329.0
Fold 2:	 Epoch 99	TRAIN LOSS: 0.2732	VALID AUC: 0.8357	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9412
token_cnts 22481500 label_sums 17977100.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 22706315 label_sums 18156871.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 22931130 label_sums 18336642.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 23155945 label_sums 18516413.0
Fold 2:	 Epoch 103	TRAIN LOSS: 0.2738	VALID AUC: 0.8267	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9485
token_cnts 23380760 label_sums 18696184.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 23605575 label_sums 18875955.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 23830390 label_sums 19055726.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 24055205 label_sums 19235497.0
Fold 2:	 Epoch 107	TRAIN LOSS: 0.2690	VALID AUC: 0.8356	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9498
token_cnts 24280020 label_sums 19415268.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 24504835 label_sums 19595039.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 24729650 label_sums 19774810.0
Fold 2:	 Epoch 110	TRAIN LOSS: 0.2657	VALID AUC: 0.8367	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9469
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  3.98it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  3.98it/s]
Fold 2:	 Epoch 111	TRAIN LOSS: 0.2656	VALID AUC: 0.8356	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9472
token_cnts 25179280 label_sums 20134352.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 25404095 label_sums 20314123.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 25628910 label_sums 20493894.0
Fold 2:	 Epoch 114	TRAIN LOSS: 0.2663	VALID AUC: 0.8319	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9433
token_cnts 25853725 label_sums 20673665.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.72it/s]
token_cnts 26078540 label_sums 20853436.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 26303355 label_sums 21033207.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 26528170 label_sums 21212978.0
Fold 2:	 Epoch 118	TRAIN LOSS: 0.2657	VALID AUC: 0.8342	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9487
token_cnts 26752985 label_sums 21392749.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 26977800 label_sums 21572520.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 27202615 label_sums 21752291.0
[ORIGINAL] Best Model	TEST AUC: 0.8367	TEST ACC: 0.8354	TEST RMSE: 0.3448
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10989.20
auc 0.8367 acc 0.8354 rmse 0.3448
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:78.21
mean of total set, question correct ratio:75.33
mean of total set, class 0 ratio:0.20
mean of total set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:77.97
mean of train set, question correct ratio:75.61
mean of train set, class 0 ratio:0.20
mean of train set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:77.97
mean of valid set, question correct ratio:75.61
mean of valid set, class 0 ratio:0.20
mean of valid set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:77.97
mean of test set, question correct ratio:75.61
mean of test set, class 0 ratio:0.20
mean of test set, class 1 ratio:0.80
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  3.98it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  3.98it/s]
Fold 3:	 Epoch 1	TRAIN LOSS: 0.5311	VALID AUC: 0.6135	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1273
token_cnts 451940 label_sums 360522.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 677910 label_sums 540783.0
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.41it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.41it/s]
token_cnts 903880 label_sums 721044.0
Fold 3:	 Epoch 4	TRAIN LOSS: 0.4619	VALID AUC: 0.6999	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1766
token_cnts 1129850 label_sums 901305.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 1355820 label_sums 1081566.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 1581790 label_sums 1261827.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 1807760 label_sums 1442088.0
Fold 3:	 Epoch 8	TRAIN LOSS: 0.4382	VALID AUC: 0.7393	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1338
token_cnts 2033730 label_sums 1622349.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 2259700 label_sums 1802610.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 2485670 label_sums 1982871.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 2711640 label_sums 2163132.0
Fold 3:	 Epoch 12	TRAIN LOSS: 0.3932	VALID AUC: 0.7934	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0784
token_cnts 2937610 label_sums 2343393.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
token_cnts 3163580 label_sums 2523654.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 3389550 label_sums 2703915.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 3615520 label_sums 2884176.0
Fold 3:	 Epoch 16	TRAIN LOSS: 0.3685	VALID AUC: 0.8068	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0878
token_cnts 3841490 label_sums 3064437.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 4067460 label_sums 3244698.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
token_cnts 4293430 label_sums 3424959.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 4519400 label_sums 3605220.0
Fold 3:	 Epoch 20	TRAIN LOSS: 0.3520	VALID AUC: 0.8102	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0796
token_cnts 4745370 label_sums 3785481.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 4971340 label_sums 3965742.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 5197310 label_sums 4146003.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
token_cnts 5423280 label_sums 4326264.0
Fold 3:	 Epoch 24	TRAIN LOSS: 0.3425	VALID AUC: 0.8137	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0788
token_cnts 5649250 label_sums 4506525.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 5875220 label_sums 4686786.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 6101190 label_sums 4867047.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 6327160 label_sums 5047308.0
Fold 3:	 Epoch 28	TRAIN LOSS: 0.3361	VALID AUC: 0.8168	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0735
token_cnts 6553130 label_sums 5227569.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 6779100 label_sums 5407830.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 7005070 label_sums 5588091.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.64it/s]
token_cnts 7231040 label_sums 5768352.0
Fold 3:	 Epoch 32	TRAIN LOSS: 0.3315	VALID AUC: 0.8175	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0591
token_cnts 7457010 label_sums 5948613.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 7682980 label_sums 6128874.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 7908950 label_sums 6309135.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 8134920 label_sums 6489396.0
Fold 3:	 Epoch 36	TRAIN LOSS: 0.3247	VALID AUC: 0.8192	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0559
token_cnts 8360890 label_sums 6669657.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 8586860 label_sums 6849918.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 8812830 label_sums 7030179.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 9038800 label_sums 7210440.0
Fold 3:	 Epoch 40	TRAIN LOSS: 0.3201	VALID AUC: 0.8195	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0496
token_cnts 9264770 label_sums 7390701.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 9490740 label_sums 7570962.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 9716710 label_sums 7751223.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 9942680 label_sums 7931484.0
Fold 3:	 Epoch 44	TRAIN LOSS: 0.3156	VALID AUC: 0.8229	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0426
token_cnts 10168650 label_sums 8111745.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.73it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.73it/s]
token_cnts 10394620 label_sums 8292006.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
token_cnts 10620590 label_sums 8472267.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 10846560 label_sums 8652528.0
Fold 3:	 Epoch 48	TRAIN LOSS: 0.3080	VALID AUC: 0.8267	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0320
token_cnts 11072530 label_sums 8832789.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 11298500 label_sums 9013050.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
token_cnts 11524470 label_sums 9193311.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 11750440 label_sums 9373572.0
Fold 3:	 Epoch 52	TRAIN LOSS: 0.3105	VALID AUC: 0.8265	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0312
token_cnts 11976410 label_sums 9553833.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 12202380 label_sums 9734094.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 12428350 label_sums 9914355.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
token_cnts 12654320 label_sums 10094616.0
Fold 3:	 Epoch 56	TRAIN LOSS: 0.3060	VALID AUC: 0.8301	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0362
token_cnts 12880290 label_sums 10274877.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 13106260 label_sums 10455138.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 13332230 label_sums 10635399.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 13558200 label_sums 10815660.0
Fold 3:	 Epoch 60	TRAIN LOSS: 0.3005	VALID AUC: 0.8318	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0186
token_cnts 13784170 label_sums 10995921.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 14010140 label_sums 11176182.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 14236110 label_sums 11356443.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
token_cnts 14462080 label_sums 11536704.0
Fold 3:	 Epoch 64	TRAIN LOSS: 0.2928	VALID AUC: 0.8328	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0266
token_cnts 14688050 label_sums 11716965.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 14914020 label_sums 11897226.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 15139990 label_sums 12077487.0
Fold 3:	 Epoch 67	TRAIN LOSS: 0.2908	VALID AUC: 0.8344	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0351
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.41it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.41it/s]
Fold 3:	 Epoch 68	TRAIN LOSS: 0.2891	VALID AUC: 0.8346	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0315
token_cnts 15591930 label_sums 12438009.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 15817900 label_sums 12618270.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 16043870 label_sums 12798531.0
Fold 3:	 Epoch 71	TRAIN LOSS: 0.2877	VALID AUC: 0.8338	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0273
token_cnts 16269840 label_sums 12978792.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 16495810 label_sums 13159053.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 16721780 label_sums 13339314.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 16947750 label_sums 13519575.0
Fold 3:	 Epoch 75	TRAIN LOSS: 0.2923	VALID AUC: 0.8339	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0339
token_cnts 17173720 label_sums 13699836.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 17399690 label_sums 13880097.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
token_cnts 17625660 label_sums 14060358.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 17851630 label_sums 14240619.0
Fold 3:	 Epoch 79	TRAIN LOSS: 0.2927	VALID AUC: 0.8279	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0416
token_cnts 18077600 label_sums 14420880.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 18303570 label_sums 14601141.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 18529540 label_sums 14781402.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 18755510 label_sums 14961663.0
Fold 3:	 Epoch 83	TRAIN LOSS: 0.2799	VALID AUC: 0.8386	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0272
token_cnts 18981480 label_sums 15141924.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 19207450 label_sums 15322185.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 19433420 label_sums 15502446.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
token_cnts 19659390 label_sums 15682707.0
Fold 3:	 Epoch 87	TRAIN LOSS: 0.2766	VALID AUC: 0.8354	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0303
token_cnts 19885360 label_sums 15862968.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 20111330 label_sums 16043229.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
token_cnts 20337300 label_sums 16223490.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 20563270 label_sums 16403751.0
Fold 3:	 Epoch 91	TRAIN LOSS: 0.2723	VALID AUC: 0.8386	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0351
token_cnts 20789240 label_sums 16584012.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 21015210 label_sums 16764273.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
token_cnts 21241180 label_sums 16944534.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
token_cnts 21467150 label_sums 17124795.0
Fold 3:	 Epoch 95	TRAIN LOSS: 0.2703	VALID AUC: 0.8397	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0362
token_cnts 21693120 label_sums 17305056.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 21919090 label_sums 17485317.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
token_cnts 22145060 label_sums 17665578.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 22371030 label_sums 17845839.0
Fold 3:	 Epoch 99	TRAIN LOSS: 0.2752	VALID AUC: 0.8371	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0441
token_cnts 22597000 label_sums 18026100.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 22822970 label_sums 18206361.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
token_cnts 23048940 label_sums 18386622.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.94it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.94it/s]
token_cnts 23274910 label_sums 18566883.0
Fold 3:	 Epoch 103	TRAIN LOSS: 0.2690	VALID AUC: 0.8432	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0377
token_cnts 23500880 label_sums 18747144.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 23726850 label_sums 18927405.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.79it/s]
token_cnts 23952820 label_sums 19107666.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 24178790 label_sums 19287927.0
Fold 3:	 Epoch 107	TRAIN LOSS: 0.2646	VALID AUC: 0.8366	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0388
token_cnts 24404760 label_sums 19468188.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 24630730 label_sums 19648449.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 24856700 label_sums 19828710.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.51it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.51it/s]
token_cnts 25082670 label_sums 20008971.0
Fold 3:	 Epoch 111	TRAIN LOSS: 0.2613	VALID AUC: 0.8421	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0410
token_cnts 25308640 label_sums 20189232.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 25534610 label_sums 20369493.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
token_cnts 25760580 label_sums 20549754.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 25986550 label_sums 20730015.0
Fold 3:	 Epoch 115	TRAIN LOSS: 0.2597	VALID AUC: 0.8374	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0443
token_cnts 26212520 label_sums 20910276.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 26438490 label_sums 21090537.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 26664460 label_sums 21270798.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 26890430 label_sums 21451059.0
Fold 3:	 Epoch 119	TRAIN LOSS: 0.2570	VALID AUC: 0.8411	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0358
token_cnts 27116400 label_sums 21631320.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
token_cnts 27342370 label_sums 21811581.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 27568340 label_sums 21991842.0
Fold 3:	 Epoch 122	TRAIN LOSS: 0.2577	VALID AUC: 0.8421	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0398
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
Fold 3:	 Epoch 123	TRAIN LOSS: 0.2570	VALID AUC: 0.8409	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0393
token_cnts 28020280 label_sums 22352364.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
token_cnts 28246250 label_sums 22532625.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.89it/s]
token_cnts 28472220 label_sums 22712886.0
Fold 3:	 Epoch 126	TRAIN LOSS: 0.2545	VALID AUC: 0.8448	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0410
token_cnts 28698190 label_sums 22893147.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 28924160 label_sums 23073408.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.58it/s]
token_cnts 29150130 label_sums 23253669.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.94it/s]
token_cnts 29376100 label_sums 23433930.0
Fold 3:	 Epoch 130	TRAIN LOSS: 0.2500	VALID AUC: 0.8360	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0365
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
[ORIGINAL] Best Model	TEST AUC: 0.8519	TEST ACC: 0.8402	TEST RMSE: 0.3393
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10977.96
auc 0.8519 acc 0.8402 rmse 0.3393
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:78.21
mean of total set, question correct ratio:75.33
mean of total set, class 0 ratio:0.20
mean of total set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:77.93
mean of train set, question correct ratio:75.39
mean of train set, class 0 ratio:0.20
mean of train set, class 1 ratio:0.80
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:77.93
mean of valid set, question correct ratio:75.39
mean of valid set, class 0 ratio:0.21
mean of valid set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:77.93
mean of test set, question correct ratio:75.39
mean of test set, class 0 ratio:0.20
mean of test set, class 1 ratio:0.80
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 4
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 229452 label_sums 183556.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
token_cnts 458904 label_sums 367112.0
Fold 4:	 Epoch 2	TRAIN LOSS: 0.4930	VALID AUC: 0.6444	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1120
token_cnts 688356 label_sums 550668.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 917808 label_sums 734224.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 1147260 label_sums 917780.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 1376712 label_sums 1101336.0
Fold 4:	 Epoch 6	TRAIN LOSS: 0.4462	VALID AUC: 0.7283	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1644
token_cnts 1606164 label_sums 1284892.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 1835616 label_sums 1468448.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  3.89it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  3.89it/s]
token_cnts 2065068 label_sums 1652004.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 2294520 label_sums 1835560.0
Fold 4:	 Epoch 10	TRAIN LOSS: 0.4203	VALID AUC: 0.7692	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1671
token_cnts 2523972 label_sums 2019116.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 2753424 label_sums 2202672.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
token_cnts 2982876 label_sums 2386228.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 3212328 label_sums 2569784.0
Fold 4:	 Epoch 14	TRAIN LOSS: 0.3803	VALID AUC: 0.8110	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1432
token_cnts 3441780 label_sums 2753340.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 3671232 label_sums 2936896.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
token_cnts 3900684 label_sums 3120452.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 4130136 label_sums 3304008.0
Fold 4:	 Epoch 18	TRAIN LOSS: 0.3607	VALID AUC: 0.8172	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1176
token_cnts 4359588 label_sums 3487564.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 4589040 label_sums 3671120.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 4818492 label_sums 3854676.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
token_cnts 5047944 label_sums 4038232.0
Fold 4:	 Epoch 22	TRAIN LOSS: 0.3461	VALID AUC: 0.8204	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1294
token_cnts 5277396 label_sums 4221788.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 5506848 label_sums 4405344.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 5736300 label_sums 4588900.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 5965752 label_sums 4772456.0
Fold 4:	 Epoch 26	TRAIN LOSS: 0.3394	VALID AUC: 0.8222	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1237
token_cnts 6195204 label_sums 4956012.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 6424656 label_sums 5139568.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.73it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.73it/s]
token_cnts 6654108 label_sums 5323124.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 6883560 label_sums 5506680.0
Fold 4:	 Epoch 30	TRAIN LOSS: 0.3366	VALID AUC: 0.8227	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1028
token_cnts 7113012 label_sums 5690236.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 7342464 label_sums 5873792.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
token_cnts 7571916 label_sums 6057348.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 7801368 label_sums 6240904.0
Fold 4:	 Epoch 34	TRAIN LOSS: 0.3343	VALID AUC: 0.8240	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0668
token_cnts 8030820 label_sums 6424460.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 8260272 label_sums 6608016.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.78it/s]
token_cnts 8489724 label_sums 6791572.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 8719176 label_sums 6975128.0
Fold 4:	 Epoch 38	TRAIN LOSS: 0.3276	VALID AUC: 0.8253	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0887
token_cnts 8948628 label_sums 7158684.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
token_cnts 9178080 label_sums 7342240.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 9407532 label_sums 7525796.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 9636984 label_sums 7709352.0
Fold 4:	 Epoch 42	TRAIN LOSS: 0.3245	VALID AUC: 0.8274	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0799
token_cnts 9866436 label_sums 7892908.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 10095888 label_sums 8076464.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 10325340 label_sums 8260020.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 10554792 label_sums 8443576.0
Fold 4:	 Epoch 46	TRAIN LOSS: 0.3213	VALID AUC: 0.8292	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0651
token_cnts 10784244 label_sums 8627132.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 11013696 label_sums 8810688.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 11243148 label_sums 8994244.0
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.41it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.41it/s]
token_cnts 11472600 label_sums 9177800.0
Fold 4:	 Epoch 50	TRAIN LOSS: 0.3198	VALID AUC: 0.8326	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0524
token_cnts 11702052 label_sums 9361356.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 11931504 label_sums 9544912.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 12160956 label_sums 9728468.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 12390408 label_sums 9912024.0
Fold 4:	 Epoch 54	TRAIN LOSS: 0.3132	VALID AUC: 0.8336	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0482
token_cnts 12619860 label_sums 10095580.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 12849312 label_sums 10279136.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 13078764 label_sums 10462692.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 13308216 label_sums 10646248.0
Fold 4:	 Epoch 58	TRAIN LOSS: 0.3091	VALID AUC: 0.8367	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0388
token_cnts 13537668 label_sums 10829804.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 13767120 label_sums 11013360.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 13996572 label_sums 11196916.0
Fold 4:	 Epoch 61	TRAIN LOSS: 0.3100	VALID AUC: 0.8336	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0413
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
Fold 4:	 Epoch 62	TRAIN LOSS: 0.3094	VALID AUC: 0.8351	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0163
token_cnts 14455476 label_sums 11564028.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 14684928 label_sums 11747584.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.90it/s]
token_cnts 14914380 label_sums 11931140.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.30it/s]
token_cnts 15143832 label_sums 12114696.0
Fold 4:	 Epoch 66	TRAIN LOSS: 0.3007	VALID AUC: 0.8372	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0212
token_cnts 15373284 label_sums 12298252.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.54it/s]
token_cnts 15602736 label_sums 12481808.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
token_cnts 15832188 label_sums 12665364.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
token_cnts 16061640 label_sums 12848920.0
Fold 4:	 Epoch 70	TRAIN LOSS: 0.2978	VALID AUC: 0.8402	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0091
token_cnts 16291092 label_sums 13032476.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 16520544 label_sums 13216032.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
token_cnts 16749996 label_sums 13399588.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
token_cnts 16979448 label_sums 13583144.0
Fold 4:	 Epoch 74	TRAIN LOSS: 0.2961	VALID AUC: 0.8415	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0016
token_cnts 17208900 label_sums 13766700.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.51it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.51it/s]
token_cnts 17438352 label_sums 13950256.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 17667804 label_sums 14133812.0
Fold 4:	 Epoch 77	TRAIN LOSS: 0.2937	VALID AUC: 0.8403	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0106
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
Fold 4:	 Epoch 78	TRAIN LOSS: 0.2936	VALID AUC: 0.8429	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0066
token_cnts 18126708 label_sums 14500924.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.52it/s]
token_cnts 18356160 label_sums 14684480.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 18585612 label_sums 14868036.0
Fold 4:	 Epoch 81	TRAIN LOSS: 0.2981	VALID AUC: 0.8411	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9974
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
Fold 4:	 Epoch 82	TRAIN LOSS: 0.2951	VALID AUC: 0.8396	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9923
token_cnts 19044516 label_sums 15235148.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 19273968 label_sums 15418704.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 19503420 label_sums 15602260.0
Fold 4:	 Epoch 85	TRAIN LOSS: 0.2910	VALID AUC: 0.8430	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9880
token_cnts 19732872 label_sums 15785816.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.65it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.65it/s]
token_cnts 19962324 label_sums 15969372.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 20191776 label_sums 16152928.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 20421228 label_sums 16336484.0
Fold 4:	 Epoch 89	TRAIN LOSS: 0.2847	VALID AUC: 0.8441	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9816
token_cnts 20650680 label_sums 16520040.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 20880132 label_sums 16703596.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 21109584 label_sums 16887152.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 21339036 label_sums 17070708.0
Fold 4:	 Epoch 93	TRAIN LOSS: 0.2823	VALID AUC: 0.8437	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9973
token_cnts 21568488 label_sums 17254264.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 21797940 label_sums 17437820.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 22027392 label_sums 17621376.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 22256844 label_sums 17804932.0
Fold 4:	 Epoch 97	TRAIN LOSS: 0.2792	VALID AUC: 0.8437	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9915
token_cnts 22486296 label_sums 17988488.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 22715748 label_sums 18172044.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 22945200 label_sums 18355600.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 23174652 label_sums 18539156.0
Fold 4:	 Epoch 101	TRAIN LOSS: 0.2810	VALID AUC: 0.8437	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9927
token_cnts 23404104 label_sums 18722712.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 23633556 label_sums 18906268.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 23863008 label_sums 19089824.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 24092460 label_sums 19273380.0
Fold 4:	 Epoch 105	TRAIN LOSS: 0.2814	VALID AUC: 0.8440	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9931
token_cnts 24321912 label_sums 19456936.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
token_cnts 24551364 label_sums 19640492.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 24780816 label_sums 19824048.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 25010268 label_sums 20007604.0
Fold 4:	 Epoch 109	TRAIN LOSS: 0.2722	VALID AUC: 0.8471	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9825
token_cnts 25239720 label_sums 20191160.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 25469172 label_sums 20374716.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 25698624 label_sums 20558272.0
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.40it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.40it/s]
token_cnts 25928076 label_sums 20741828.0
Fold 4:	 Epoch 113	TRAIN LOSS: 0.2691	VALID AUC: 0.8473	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9810
token_cnts 26157528 label_sums 20925384.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 26386980 label_sums 21108940.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
token_cnts 26616432 label_sums 21292496.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 26845884 label_sums 21476052.0
Fold 4:	 Epoch 117	TRAIN LOSS: 0.2695	VALID AUC: 0.8436	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9845
token_cnts 27075336 label_sums 21659608.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 27304788 label_sums 21843164.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 27534240 label_sums 22026720.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 27763692 label_sums 22210276.0
Fold 4:	 Epoch 121	TRAIN LOSS: 0.2680	VALID AUC: 0.8480	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9717
token_cnts 27993144 label_sums 22393832.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 28222596 label_sums 22577388.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 28452048 label_sums 22760944.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 28681500 label_sums 22944500.0
Fold 4:	 Epoch 125	TRAIN LOSS: 0.2616	VALID AUC: 0.8522	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9701
token_cnts 28910952 label_sums 23128056.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  3.91it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  3.91it/s]
token_cnts 29140404 label_sums 23311612.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 29369856 label_sums 23495168.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 29599308 label_sums 23678724.0
Fold 4:	 Epoch 129	TRAIN LOSS: 0.2732	VALID AUC: 0.8492	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9969
token_cnts 29828760 label_sums 23862280.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 30058212 label_sums 24045836.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 30287664 label_sums 24229392.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 30517116 label_sums 24412948.0
Fold 4:	 Epoch 133	TRAIN LOSS: 0.2603	VALID AUC: 0.8462	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9655
token_cnts 30746568 label_sums 24596504.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 30976020 label_sums 24780060.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 31205472 label_sums 24963616.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
token_cnts 31434924 label_sums 25147172.0
Fold 4:	 Epoch 137	TRAIN LOSS: 0.2572	VALID AUC: 0.8479	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 0.9676
token_cnts 31664376 label_sums 25330728.0
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 31893828 label_sums 25514284.0
[ORIGINAL] Best Model	TEST AUC: 0.8510	TEST ACC: 0.8391	TEST RMSE: 0.3389
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10973.30
auc 0.8510 acc 0.8391 rmse 0.3389
Average Inference Speed: 10982.09 samples/second (±6.27)
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]