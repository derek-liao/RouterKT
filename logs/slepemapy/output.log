
[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
skill_min 0
# user: 5000
# skill: 1379, 1380
# question: 2712, 2713
# interaction: 623212
MODEL routerakt
<class 'data_loaders.MostRecentQuestionSkillDataset'>
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:76.39
mean of total set, question correct ratio:77.44
mean of total set, class 0 ratio:0.21
mean of total set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:76.40
mean of train set, question correct ratio:77.44
mean of train set, class 0 ratio:0.21
mean of train set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:76.40
mean of valid set, question correct ratio:77.44
mean of valid set, class 0 ratio:0.22
mean of valid set, class 1 ratio:0.78
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:76.40
mean of test set, question correct ratio:77.44
mean of test set, class 0 ratio:0.21
mean of test set, class 1 ratio:0.79
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 1
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.19it/s]
token_cnts 198801 label_sums 156588.0
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  3.40it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.70it/s]
token_cnts 397602 label_sums 313176.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.57it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.34it/s]
token_cnts 596403 label_sums 469764.0
Fold 0:	 Epoch 3	TRAIN LOSS: 0.5085	VALID AUC: 0.6238	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.7608
token_cnts 795204 label_sums 626352.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.18it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.26it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 994005 label_sums 782940.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.25it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.97it/s]
token_cnts 1192806 label_sums 939528.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.22it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.55it/s]
token_cnts 1391607 label_sums 1096116.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.61it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:00,  4.13it/s]
token_cnts 1590408 label_sums 1252704.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.90it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.68it/s]
token_cnts 1789209 label_sums 1409292.0
Fold 0:	 Epoch 9	TRAIN LOSS: 0.4465	VALID AUC: 0.7403	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.5437
token_cnts 1988010 label_sums 1565880.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.30it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.23it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 2186811 label_sums 1722468.0
100%|█████████████████████████████████████████████| 8/8 [00:07<00:00,  1.10it/s]

 12%|█████▋                                       | 1/8 [00:00<00:02,  3.12it/s]
token_cnts 2385612 label_sums 1879056.0
100%|█████████████████████████████████████████████| 8/8 [00:05<00:00,  1.51it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.28it/s]
token_cnts 2584413 label_sums 2035644.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.44it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.82it/s]
token_cnts 2783214 label_sums 2192232.0
Fold 0:	 Epoch 14	TRAIN LOSS: 0.4304	VALID AUC: 0.7480	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.5075
token_cnts 2982015 label_sums 2348820.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.60it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.60it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 3180816 label_sums 2505408.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.65it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.15it/s]
token_cnts 3379617 label_sums 2661996.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.85it/s]
token_cnts 3578418 label_sums 2818584.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.60it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.12it/s]
token_cnts 3777219 label_sums 2975172.0
Fold 0:	 Epoch 19	TRAIN LOSS: 0.4139	VALID AUC: 0.7514	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6154
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.92it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.07it/s]
Fold 0:	 Epoch 20	TRAIN LOSS: 0.4101	VALID AUC: 0.7510	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6328
token_cnts 4174821 label_sums 3288348.0
Fold 0:	 Epoch 21	TRAIN LOSS: 0.4070	VALID AUC: 0.7518	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6519
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.17it/s]


 62%|████████████████████████████▏                | 5/8 [00:02<00:02,  1.17it/s]
token_cnts 4373622 label_sums 3444936.0
100%|█████████████████████████████████████████████| 8/8 [00:05<00:00,  1.45it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.86it/s]
token_cnts 4572423 label_sums 3601524.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.40it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.77it/s]
token_cnts 4771224 label_sums 3758112.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.98it/s]
token_cnts 4970025 label_sums 3914700.0
Fold 0:	 Epoch 25	TRAIN LOSS: 0.4121	VALID AUC: 0.7451	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6404
token_cnts 5168826 label_sums 4071288.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.49it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 5367627 label_sums 4227876.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.64it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.57it/s]
token_cnts 5566428 label_sums 4384464.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 5765229 label_sums 4541052.0
Fold 0:	 Epoch 29	TRAIN LOSS: 0.3822	VALID AUC: 0.7514	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6737
token_cnts 5964030 label_sums 4697640.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 6162831 label_sums 4854228.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.01it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.13it/s]
token_cnts 6361632 label_sums 5010816.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.92it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.65it/s]
token_cnts 6560433 label_sums 5167404.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.24it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.77it/s]
token_cnts 6759234 label_sums 5323992.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.07it/s]

 62%|████████████████████████████▏                | 5/8 [00:03<00:03,  1.15s/it]
token_cnts 6958035 label_sums 5480580.0
100%|█████████████████████████████████████████████| 8/8 [00:05<00:00,  1.48it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.59it/s]
token_cnts 7156836 label_sums 5637168.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.17it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.34it/s]
token_cnts 7355637 label_sums 5793756.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.15it/s]
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.15it/s]
token_cnts 7554438 label_sums 5950344.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.05it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.39it/s]
token_cnts 7753239 label_sums 6106932.0
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  3.01it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 7952040 label_sums 6263520.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.11it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.16it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
Fold 0:	 Epoch 41	TRAIN LOSS: 0.3570	VALID AUC: 0.7543	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.7149

100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.17it/s]
Fold 0:	 Epoch 42	TRAIN LOSS: 0.3552	VALID AUC: 0.7506	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.7079
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.22it/s]
token_cnts 8548443 label_sums 6733284.0
Fold 0:	 Epoch 43	TRAIN LOSS: 0.3536	VALID AUC: 0.7532	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.7102
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.21it/s]
token_cnts 8747244 label_sums 6889872.0
Fold 0:	 Epoch 44	TRAIN LOSS: 0.3539	VALID AUC: 0.7512	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.7278
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.50it/s]
token_cnts 8946045 label_sums 7046460.0
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  4.00it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.35it/s]
token_cnts 9144846 label_sums 7203048.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.02it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.71it/s]
token_cnts 9343647 label_sums 7359636.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.21it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.62it/s]
token_cnts 9542448 label_sums 7516224.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.49it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.50it/s]
token_cnts 9741249 label_sums 7672812.0
Fold 0:	 Epoch 49	TRAIN LOSS: 0.3430	VALID AUC: 0.7496	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6767
token_cnts 9940050 label_sums 7829400.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.24it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.28it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 10138851 label_sums 7985988.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.65it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.08it/s]

100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.51it/s]
[ORIGINAL] Best Model	TEST AUC: 0.7511	TEST ACC: 0.7908	TEST RMSE: 0.3852
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 9296.83
auc 0.7511 acc 0.7908 rmse 0.3852
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:76.39
mean of total set, question correct ratio:77.44
mean of total set, class 0 ratio:0.21
mean of total set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:76.61
mean of train set, question correct ratio:77.74
mean of train set, class 0 ratio:0.21
mean of train set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:76.61
mean of valid set, question correct ratio:77.74
mean of valid set, class 0 ratio:0.21
mean of valid set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:76.61
mean of test set, question correct ratio:77.74
mean of test set, class 0 ratio:0.21
mean of test set, class 1 ratio:0.79
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 1
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.33it/s]
token_cnts 196874 label_sums 154696.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.29it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.79it/s]
token_cnts 393748 label_sums 309392.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.75it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.36it/s]
token_cnts 590622 label_sums 464088.0
Fold 1:	 Epoch 3	TRAIN LOSS: 0.5111	VALID AUC: 0.6483	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1170
token_cnts 787496 label_sums 618784.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.48it/s]
Fold 1:	 Epoch 4	TRAIN LOSS: 0.4921	VALID AUC: 0.6940	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1875
token_cnts 984370 label_sums 773480.0
Fold 1:	 Epoch 5	TRAIN LOSS: 0.4774	VALID AUC: 0.7124	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3393
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.05it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 1181244 label_sums 928176.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.07it/s]
token_cnts 1378118 label_sums 1082872.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.39it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.25it/s]
token_cnts 1574992 label_sums 1237568.0
Fold 1:	 Epoch 8	TRAIN LOSS: 0.4510	VALID AUC: 0.7383	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3573
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.16it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.07it/s]
Fold 1:	 Epoch 9	TRAIN LOSS: 0.4455	VALID AUC: 0.7402	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3558
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.96it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.23it/s]
Fold 1:	 Epoch 10	TRAIN LOSS: 0.4397	VALID AUC: 0.7428	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3587
token_cnts 2165614 label_sums 1701656.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.16it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.32it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.24it/s]

 62%|████████████████████████████▏                | 5/8 [00:05<00:04,  1.54s/it]
Fold 1:	 Epoch 12	TRAIN LOSS: 0.4344	VALID AUC: 0.7457	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3506
100%|█████████████████████████████████████████████| 8/8 [00:06<00:00,  1.29it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.17it/s]
Fold 1:	 Epoch 13	TRAIN LOSS: 0.4289	VALID AUC: 0.7472	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3231
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.29it/s]
token_cnts 2756236 label_sums 2165744.0

 75%|█████████████████████████████████▊           | 6/8 [00:02<00:00,  2.56it/s]
token_cnts 2953110 label_sums 2320440.0
100%|█████████████████████████████████████████████| 8/8 [00:03<00:00,  2.64it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 3149984 label_sums 2475136.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.38it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.81it/s]
token_cnts 3346858 label_sums 2629832.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.07it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.19it/s]
token_cnts 3543732 label_sums 2784528.0
Fold 1:	 Epoch 18	TRAIN LOSS: 0.4076	VALID AUC: 0.7514	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2973
token_cnts 3740606 label_sums 2939224.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.31it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.70it/s]
token_cnts 3937480 label_sums 3093920.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.60it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 4134354 label_sums 3248616.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.80it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.86it/s]
token_cnts 4331228 label_sums 3403312.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.34it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.97it/s]
token_cnts 4528102 label_sums 3558008.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.20it/s]

 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.21it/s]
token_cnts 4724976 label_sums 3712704.0
100%|█████████████████████████████████████████████| 8/8 [00:06<00:00,  1.28it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.92it/s]
token_cnts 4921850 label_sums 3867400.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.59it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.01it/s]
token_cnts 5118724 label_sums 4022096.0
Fold 1:	 Epoch 26	TRAIN LOSS: 0.3837	VALID AUC: 0.7535	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3162
token_cnts 5315598 label_sums 4176792.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 5512472 label_sums 4331488.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.74it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 5709346 label_sums 4486184.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.51it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.82it/s]
token_cnts 5906220 label_sums 4640880.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.26it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.39it/s]
token_cnts 6103094 label_sums 4795576.0
Fold 1:	 Epoch 31	TRAIN LOSS: 0.3739	VALID AUC: 0.7544	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2975
token_cnts 6299968 label_sums 4950272.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.31it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 6496842 label_sums 5104968.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.64it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.62it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 6693716 label_sums 5259664.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.65it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.88it/s]
token_cnts 6890590 label_sums 5414360.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.03it/s]
 12%|█████▋                                       | 1/8 [00:00<00:04,  1.55it/s]
token_cnts 7087464 label_sums 5569056.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.32it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.80it/s]

100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.14it/s]
Fold 1:	 Epoch 37	TRAIN LOSS: 0.3647	VALID AUC: 0.7500	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3581
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.64it/s]
token_cnts 7481212 label_sums 5878448.0
Fold 1:	 Epoch 38	TRAIN LOSS: 0.3617	VALID AUC: 0.7484	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3670
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.32it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.89it/s]
[ORIGINAL] Best Model	TEST AUC: 0.7572	TEST ACC: 0.7958	TEST RMSE: 0.3810
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 19809.31
auc 0.7572 acc 0.7958 rmse 0.3810
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:76.39
mean of total set, question correct ratio:77.44
mean of total set, class 0 ratio:0.21
mean of total set, class 1 ratio:0.79

100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.42it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.94it/s]
# of train set, 3600
mean of train set, skill correct ratio:76.77
mean of train set, question correct ratio:77.78
mean of train set, class 0 ratio:0.21
mean of train set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:76.77
mean of valid set, question correct ratio:77.78
mean of valid set, class 0 ratio:0.21
mean of valid set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:76.77
mean of test set, question correct ratio:77.78
mean of test set, class 0 ratio:0.21
mean of test set, class 1 ratio:0.79
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 1
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
token_cnts 200107 label_sums 157518.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.20it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.60it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 400214 label_sums 315036.0

100%|█████████████████████████████████████████████| 8/8 [00:03<00:00,  2.27it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.15it/s]
token_cnts 600321 label_sums 472554.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.65it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.65it/s]
token_cnts 800428 label_sums 630072.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.24it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.33it/s]
token_cnts 1000535 label_sums 787590.0
Fold 2:	 Epoch 5	TRAIN LOSS: 0.4698	VALID AUC: 0.7007	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4003
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.03it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.03it/s]
Fold 2:	 Epoch 6	TRAIN LOSS: 0.4597	VALID AUC: 0.7160	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3824
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.38it/s]
 88%|███████████████████████████████████████▍     | 7/8 [00:01<00:00,  4.63it/s]
Fold 2:	 Epoch 7	TRAIN LOSS: 0.4541	VALID AUC: 0.7232	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3864

100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.75it/s]
 25%|███████████▎                                 | 2/8 [00:01<00:03,  1.61it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.63it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.63it/s]
token_cnts 1800963 label_sums 1417662.0
 12%|█████▋                                       | 1/8 [00:00<00:03,  2.21it/s]
 12%|█████▋                                       | 1/8 [00:00<00:03,  2.21it/s]
token_cnts 2001070 label_sums 1575180.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 2201177 label_sums 1732698.0
Fold 2:	 Epoch 11	TRAIN LOSS: 0.4289	VALID AUC: 0.7373	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3572
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 2401284 label_sums 1890216.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.10it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.10it/s]
token_cnts 2601391 label_sums 2047734.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.12it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.12it/s]
token_cnts 2801498 label_sums 2205252.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.33it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.33it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.48it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  3.48it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.18it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.18it/s]
token_cnts 3201712 label_sums 2520288.0
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.12it/s]
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.12it/s]
token_cnts 3401819 label_sums 2677806.0
 25%|███████████▎                                 | 2/8 [00:00<00:02,  2.99it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:02,  2.99it/s]
token_cnts 3601926 label_sums 2835324.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.86it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.86it/s]
token_cnts 3802033 label_sums 2992842.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.03it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.03it/s]
token_cnts 4002140 label_sums 3150360.0
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.81it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.81it/s]
token_cnts 4202247 label_sums 3307878.0
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.76it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.76it/s]
token_cnts 4402354 label_sums 3465396.0
Fold 2:	 Epoch 22	TRAIN LOSS: 0.3913	VALID AUC: 0.7476	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4010
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.03it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.03it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.80it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.80it/s]
token_cnts 4802568 label_sums 3780432.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.25it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.25it/s]
token_cnts 5002675 label_sums 3937950.0
Fold 2:	 Epoch 25	TRAIN LOSS: 0.3870	VALID AUC: 0.7483	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3969
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
Fold 2:	 Epoch 26	TRAIN LOSS: 0.3809	VALID AUC: 0.7463	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4064
token_cnts 5402889 label_sums 4252986.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.67it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.98it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.98it/s]
token_cnts 5602996 label_sums 4410504.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.54it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.54it/s]
token_cnts 5803103 label_sums 4568022.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.76it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.64it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.64it/s]
token_cnts 6003210 label_sums 4725540.0
Fold 2:	 Epoch 30	TRAIN LOSS: 0.3764	VALID AUC: 0.7456	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4420
token_cnts 6203317 label_sums 4883058.0
[ORIGINAL] Best Model	TEST AUC: 0.7579	TEST ACC: 0.7927	TEST RMSE: 0.3815
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 11367.45
auc 0.7579 acc 0.7927 rmse 0.3815
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:76.39
mean of total set, question correct ratio:77.44
mean of total set, class 0 ratio:0.21
mean of total set, class 1 ratio:0.79
 12%|█████▋                                       | 1/8 [00:01<00:09,  1.37s/it]
 12%|█████▋                                       | 1/8 [00:01<00:09,  1.37s/it]
# of train set, 3600
mean of train set, skill correct ratio:76.67
mean of train set, question correct ratio:77.63
mean of train set, class 0 ratio:0.21
mean of train set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:76.67
mean of valid set, question correct ratio:77.63
mean of valid set, class 0 ratio:0.21
mean of valid set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:76.67
mean of test set, question correct ratio:77.63
mean of test set, class 0 ratio:0.22
mean of test set, class 1 ratio:0.78
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 1
num_shared_heads: 1
routing_mode: dynamic
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.01it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.01it/s]
token_cnts 197152 label_sums 155431.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.18it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.18it/s]
token_cnts 394304 label_sums 310862.0
 38%|████████████████▉                            | 3/8 [00:04<00:09,  1.98s/it]
 62%|████████████████████████████▏                | 5/8 [00:08<00:05,  1.80s/it]
 62%|████████████████████████████▏                | 5/8 [00:08<00:05,  1.80s/it]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
Fold 3:	 Epoch 3	TRAIN LOSS: 0.5090	VALID AUC: 0.6594	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 2.0078
token_cnts 788608 label_sums 621724.0
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  3.90it/s]
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  3.90it/s]
token_cnts 985760 label_sums 777155.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 1182912 label_sums 932586.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.15it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.15it/s]
token_cnts 1380064 label_sums 1088017.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.78it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.78it/s]
token_cnts 1577216 label_sums 1243448.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.55it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.55it/s]
token_cnts 1774368 label_sums 1398879.0
Fold 3:	 Epoch 9	TRAIN LOSS: 0.4433	VALID AUC: 0.7485	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6749
token_cnts 1971520 label_sums 1554310.0
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.24it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  3.24it/s]
token_cnts 2168672 label_sums 1709741.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.88it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.88it/s]
token_cnts 2365824 label_sums 1865172.0
 25%|███████████▎                                 | 2/8 [00:00<00:02,  2.20it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:02,  2.20it/s]
token_cnts 2562976 label_sums 2020603.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.33it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.33it/s]
token_cnts 2760128 label_sums 2176034.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 2957280 label_sums 2331465.0
 50%|██████████████████████▌                      | 4/8 [00:07<00:04,  1.06s/it]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.46it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.46it/s]
token_cnts 3154432 label_sums 2486896.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 3351584 label_sums 2642327.0
Fold 3:	 Epoch 17	TRAIN LOSS: 0.4112	VALID AUC: 0.7572	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.5453
token_cnts 3548736 label_sums 2797758.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.16it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.16it/s]
token_cnts 3745888 label_sums 2953189.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.74it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.74it/s]
token_cnts 3943040 label_sums 3108620.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.77it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.77it/s]
token_cnts 4140192 label_sums 3264051.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 4337344 label_sums 3419482.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.17it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.17it/s]
token_cnts 4534496 label_sums 3574913.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.83it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.83it/s]
token_cnts 4731648 label_sums 3730344.0
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.00it/s]
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.00it/s]
token_cnts 4928800 label_sums 3885775.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.53it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.53it/s]
token_cnts 5125952 label_sums 4041206.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 5323104 label_sums 4196637.0
 12%|█████▋                                       | 1/8 [00:05<00:37,  5.29s/it]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 5520256 label_sums 4352068.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.60it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.60it/s]
token_cnts 5717408 label_sums 4507499.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.91it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 5914560 label_sums 4662930.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 6111712 label_sums 4818361.0
Fold 3:	 Epoch 31	TRAIN LOSS: 0.3656	VALID AUC: 0.7593	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4865
token_cnts 6308864 label_sums 4973792.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.17it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.17it/s]
token_cnts 6506016 label_sums 5129223.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.77it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.77it/s]
token_cnts 6703168 label_sums 5284654.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  5.66it/s]
token_cnts 6900320 label_sums 5440085.0
Fold 3:	 Epoch 35	TRAIN LOSS: 0.3569	VALID AUC: 0.7569	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4734
token_cnts 7097472 label_sums 5595516.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 7294624 label_sums 5750947.0
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.88it/s]
 12%|█████▋                                       | 1/8 [00:00<00:02,  2.88it/s]
token_cnts 7491776 label_sums 5906378.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.79it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.79it/s]
token_cnts 7688928 label_sums 6061809.0
 12%|█████▋                                       | 1/8 [00:00<00:03,  2.16it/s]
 12%|█████▋                                       | 1/8 [00:00<00:03,  2.16it/s]
token_cnts 7886080 label_sums 6217240.0
100%|█████████████████████████████████████████████| 8/8 [00:04<00:00,  1.77it/s]
100%|█████████████████████████████████████████████| 8/8 [00:04<00:00,  1.77it/s]
token_cnts 8083232 label_sums 6372671.0
[ORIGINAL] Best Model	TEST AUC: 0.7545	TEST ACC: 0.7883	TEST RMSE: 0.3868
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 19470.90
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:76.39
mean of total set, question correct ratio:77.44
mean of total set, class 0 ratio:0.21
mean of total set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:76.63
mean of train set, question correct ratio:77.70
mean of train set, class 0 ratio:0.21
mean of train set, class 1 ratio:0.79
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:76.63
mean of valid set, question correct ratio:77.70
mean of valid set, class 0 ratio:0.22
mean of valid set, class 1 ratio:0.78
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:76.63
mean of test set, question correct ratio:77.70
mean of test set, class 0 ratio:0.20
mean of test set, class 1 ratio:0.80
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 1
num_shared_heads: 1
routing_mode: dynamic
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  3.47it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.27it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.27it/s]
token_cnts 197345 label_sums 154991.0
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.15it/s]
 38%|████████████████▉                            | 3/8 [00:01<00:01,  3.15it/s]
token_cnts 394690 label_sums 309982.0
 12%|█████▋                                       | 1/8 [00:00<00:03,  1.95it/s]
 12%|█████▋                                       | 1/8 [00:00<00:03,  1.95it/s]
token_cnts 592035 label_sums 464973.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 789380 label_sums 619964.0
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  3.75it/s]
100%|█████████████████████████████████████████████| 8/8 [00:02<00:00,  3.75it/s]
token_cnts 986725 label_sums 774955.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.36it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.36it/s]
token_cnts 1184070 label_sums 929946.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.48it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.48it/s]
token_cnts 1381415 label_sums 1084937.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.35it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.35it/s]
token_cnts 1578760 label_sums 1239928.0
 50%|██████████████████████▌                      | 4/8 [00:01<00:01,  3.58it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.79it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.79it/s]
token_cnts 1776105 label_sums 1394919.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.35it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.35it/s]
token_cnts 1973450 label_sums 1549910.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.65it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.65it/s]
token_cnts 2170795 label_sums 1704901.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 2368140 label_sums 1859892.0
Fold 4:	 Epoch 12	TRAIN LOSS: 0.4326	VALID AUC: 0.7331	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3878
token_cnts 2565485 label_sums 2014883.0
Fold 4:	 Epoch 13	TRAIN LOSS: 0.4308	VALID AUC: 0.7363	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3628
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 2762830 label_sums 2169874.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.56it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  3.56it/s]
token_cnts 2960175 label_sums 2324865.0
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.66it/s]
 50%|██████████████████████▌                      | 4/8 [00:00<00:00,  4.66it/s]
token_cnts 3157520 label_sums 2479856.0
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.87it/s]
 75%|█████████████████████████████████▊           | 6/8 [00:01<00:00,  4.87it/s]
token_cnts 3354865 label_sums 2634847.0
Fold 4:	 Epoch 17	TRAIN LOSS: 0.4158	VALID AUC: 0.7396	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3571
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
Fold 4:	 Epoch 18	TRAIN LOSS: 0.4116	VALID AUC: 0.7399	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3615
token_cnts 3749555 label_sums 2944829.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.23it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  4.23it/s]
token_cnts 3946900 label_sums 3099820.0
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.93it/s]
 62%|████████████████████████████▏                | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 4144245 label_sums 3254811.0
  0%|                                                     | 0/8 [00:00<?, ?it/s]
  0%|                                                     | 0/8 [00:00<?, ?it/s]
token_cnts 4341590 label_sums 3409802.0
Fold 4:	 Epoch 22	TRAIN LOSS: 0.4037	VALID AUC: 0.7401	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3147
token_cnts 4538935 label_sums 3564793.0
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.13it/s]
 25%|███████████▎                                 | 2/8 [00:00<00:01,  4.13it/s]
token_cnts 4736280 label_sums 3719784.0
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.90it/s]
 38%|████████████████▉                            | 3/8 [00:00<00:01,  3.90it/s]
token_cnts 4933625 label_sums 3874775.0
 50%|██████████████████████▌                      | 4/8 [00:01<00:00,  4.21it/s]
 50%|██████████████████████▌                      | 4/8 [00:01<00:00,  4.21it/s]
token_cnts 5130970 label_sums 4029766.0
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.65it/s]
100%|█████████████████████████████████████████████| 8/8 [00:01<00:00,  4.65it/s]
token_cnts 5328315 label_sums 4184757.0
[ORIGINAL] Best Model	TEST AUC: 0.7518	TEST ACC: 0.8014	TEST RMSE: 0.3774
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 19542.66
auc 0.7518 acc 0.8014 rmse 0.3774
Average Inference Speed: 15897.43 samples/second (±4592.36)