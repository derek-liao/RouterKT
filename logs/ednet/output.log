[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:03,  2.28it/s]
skill_min 0
# user: 5000
# skill: 1775, 1776
# question: 12141, 12142
# interaction: 735557
MODEL routerakt
<class 'data_loaders.MostRecentQuestionSkillDataset'>
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:71.60
mean of total set, question correct ratio:69.62
mean of total set, class 0 ratio:0.43
mean of total set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:71.60
mean of train set, question correct ratio:69.62
mean of train set, class 0 ratio:0.43
mean of train set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:71.60
mean of valid set, question correct ratio:69.62
mean of valid set, class 0 ratio:0.42
mean of valid set, class 1 ratio:0.58
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:71.60
mean of test set, question correct ratio:69.62
mean of test set, class 0 ratio:0.43
mean of test set, class 1 ratio:0.57
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 2
num_shared_heads: 1
routing_mode: dynamic
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  4.75it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 123833 label_sums 71024.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 247666 label_sums 142048.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 371499 label_sums 213072.0
Fold 0:	 Epoch 3	TRAIN LOSS: 0.6671	VALID AUC: 0.6405	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2864
token_cnts 495332 label_sums 284096.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 619165 label_sums 355120.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.97it/s]
token_cnts 742998 label_sums 426144.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 866831 label_sums 497168.0
Fold 0:	 Epoch 7	TRAIN LOSS: 0.6286	VALID AUC: 0.6783	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2542
token_cnts 990664 label_sums 568192.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 1114497 label_sums 639216.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 7/8 [00:01<00:00,  5.42it/s]
token_cnts 1238330 label_sums 710240.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.04it/s]
token_cnts 1362163 label_sums 781264.0
Fold 0:	 Epoch 11	TRAIN LOSS: 0.5966	VALID AUC: 0.6922	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2953
token_cnts 1485996 label_sums 852288.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 1609829 label_sums 923312.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 1733662 label_sums 994336.0
Fold 0:	 Epoch 14	TRAIN LOSS: 0.5471	VALID AUC: 0.6903	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2556
token_cnts 1857495 label_sums 1065360.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s][34m[1mwandb[39m[22m: 429 encountered (Filestream rate limit exceeded, retrying in 2.4 seconds.), retrying request
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
Fold 0:	 Epoch 15	TRAIN LOSS: 0.5349	VALID AUC: 0.6970	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2637
token_cnts 1981328 label_sums 1136384.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 2105161 label_sums 1207408.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 2228994 label_sums 1278432.0
Fold 0:	 Epoch 18	TRAIN LOSS: 0.5195	VALID AUC: 0.7014	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3258
token_cnts 2352827 label_sums 1349456.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
Fold 0:	 Epoch 19	TRAIN LOSS: 0.5302	VALID AUC: 0.6965	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3232
token_cnts 2476660 label_sums 1420480.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 2600493 label_sums 1491504.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2724326 label_sums 1562528.0
Fold 0:	 Epoch 22	TRAIN LOSS: 0.4893	VALID AUC: 0.6990	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2504
token_cnts 2848159 label_sums 1633552.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 2971992 label_sums 1704576.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 3095825 label_sums 1775600.0
Fold 0:	 Epoch 25	TRAIN LOSS: 0.4700	VALID AUC: 0.7065	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2758
token_cnts 3219658 label_sums 1846624.0
Fold 0:	 Epoch 26	TRAIN LOSS: 0.4700	VALID AUC: 0.7032	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2538
token_cnts 3343491 label_sums 1917648.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 3467324 label_sums 1988672.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.37it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 3591157 label_sums 2059696.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 3714990 label_sums 2130720.0
Fold 0:	 Epoch 30	TRAIN LOSS: 0.4505	VALID AUC: 0.7048	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3392
token_cnts 3838823 label_sums 2201744.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 3962656 label_sums 2272768.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 4086489 label_sums 2343792.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 4210322 label_sums 2414816.0
Fold 0:	 Epoch 34	TRAIN LOSS: 0.4653	VALID AUC: 0.6996	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3911
token_cnts 4334155 label_sums 2485840.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 4457988 label_sums 2556864.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 4581821 label_sums 2627888.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 4705654 label_sums 2698912.0
Fold 0:	 Epoch 38	TRAIN LOSS: 0.4348	VALID AUC: 0.6992	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4979
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
[ORIGINAL] Best Model	TEST AUC: 0.7107	TEST ACC: 0.6623	TEST RMSE: 0.4719
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10980.46
auc 0.7107 acc 0.6623 rmse 0.4719
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:71.60
mean of total set, question correct ratio:69.62
mean of total set, class 0 ratio:0.43
mean of total set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:71.64
mean of train set, question correct ratio:69.63
mean of train set, class 0 ratio:0.43
mean of train set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:71.64
mean of valid set, question correct ratio:69.63
mean of valid set, class 0 ratio:0.43
mean of valid set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:71.64
mean of test set, question correct ratio:69.63
mean of test set, class 0 ratio:0.42
mean of test set, class 1 ratio:0.58
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 2
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 121085 label_sums 69544.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 242170 label_sums 139088.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 363255 label_sums 208632.0
Fold 1:	 Epoch 3	TRAIN LOSS: 0.6693	VALID AUC: 0.6348	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.5442
token_cnts 484340 label_sums 278176.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 605425 label_sums 347720.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 726510 label_sums 417264.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 847595 label_sums 486808.0
Fold 1:	 Epoch 7	TRAIN LOSS: 0.6259	VALID AUC: 0.6693	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4538
token_cnts 968680 label_sums 556352.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 1089765 label_sums 625896.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 1210850 label_sums 695440.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 1331935 label_sums 764984.0
Fold 1:	 Epoch 11	TRAIN LOSS: 0.5909	VALID AUC: 0.6912	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4599
token_cnts 1453020 label_sums 834528.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.00it/s]
token_cnts 1574105 label_sums 904072.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.35it/s]
token_cnts 1695190 label_sums 973616.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.36it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 1816275 label_sums 1043160.0
Fold 1:	 Epoch 15	TRAIN LOSS: 0.5295	VALID AUC: 0.7058	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4119
token_cnts 1937360 label_sums 1112704.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 2058445 label_sums 1182248.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 2179530 label_sums 1251792.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 2300615 label_sums 1321336.0
Fold 1:	 Epoch 19	TRAIN LOSS: 0.4999	VALID AUC: 0.7046	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4369
token_cnts 2421700 label_sums 1390880.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 2542785 label_sums 1460424.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 2663870 label_sums 1529968.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
token_cnts 2784955 label_sums 1599512.0
Fold 1:	 Epoch 23	TRAIN LOSS: 0.4687	VALID AUC: 0.7144	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4396
token_cnts 2906040 label_sums 1669056.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 3027125 label_sums 1738600.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 3148210 label_sums 1808144.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 3269295 label_sums 1877688.0
Fold 1:	 Epoch 27	TRAIN LOSS: 0.4788	VALID AUC: 0.6972	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3973
token_cnts 3390380 label_sums 1947232.0
Fold 1:	 Epoch 28	TRAIN LOSS: 0.4743	VALID AUC: 0.6891	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3024
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.57it/s]
token_cnts 3511465 label_sums 2016776.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 3632550 label_sums 2086320.0
Fold 1:	 Epoch 30	TRAIN LOSS: 0.4631	VALID AUC: 0.7060	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3765
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 1:	 Epoch 31	TRAIN LOSS: 0.4610	VALID AUC: 0.6932	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4119
token_cnts 3874720 label_sums 2225408.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 3995805 label_sums 2294952.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 4116890 label_sums 2364496.0
Fold 1:	 Epoch 34	TRAIN LOSS: 0.4622	VALID AUC: 0.6978	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3155
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
[ORIGINAL] Best Model	TEST AUC: 0.7289	TEST ACC: 0.6741	TEST RMSE: 0.4667
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10986.53
auc 0.7289 acc 0.6741 rmse 0.4667
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:71.60
mean of total set, question correct ratio:69.62
mean of total set, class 0 ratio:0.43
mean of total set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:71.55
mean of train set, question correct ratio:69.55
mean of train set, class 0 ratio:0.42
mean of train set, class 1 ratio:0.58
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:71.55
mean of valid set, question correct ratio:69.55
mean of valid set, class 0 ratio:0.44
mean of valid set, class 1 ratio:0.56
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:71.55
mean of test set, question correct ratio:69.55
mean of test set, class 0 ratio:0.43
mean of test set, class 1 ratio:0.57
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 2
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.53it/s]
token_cnts 123601 label_sums 71051.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 247202 label_sums 142102.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 370803 label_sums 213153.0
Fold 2:	 Epoch 3	TRAIN LOSS: 0.6677	VALID AUC: 0.6478	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.6466
token_cnts 494404 label_sums 284204.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 618005 label_sums 355255.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
token_cnts 741606 label_sums 426306.0
Fold 2:	 Epoch 6	TRAIN LOSS: 0.6327	VALID AUC: 0.6728	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2773
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 2:	 Epoch 7	TRAIN LOSS: 0.6240	VALID AUC: 0.6731	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2604
token_cnts 988808 label_sums 568408.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 1112409 label_sums 639459.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 1236010 label_sums 710510.0
Fold 2:	 Epoch 10	TRAIN LOSS: 0.5913	VALID AUC: 0.6911	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1147
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 2:	 Epoch 11	TRAIN LOSS: 0.5781	VALID AUC: 0.7012	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1776
token_cnts 1483212 label_sums 852612.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.56it/s]
token_cnts 1606813 label_sums 923663.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 1730414 label_sums 994714.0
Fold 2:	 Epoch 14	TRAIN LOSS: 0.5446	VALID AUC: 0.6952	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1298
token_cnts 1854015 label_sums 1065765.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 1977616 label_sums 1136816.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 25%|█████████████████████████████▎                                                                                       | 2/8 [00:00<00:01,  4.55it/s]
token_cnts 2101217 label_sums 1207867.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 2224818 label_sums 1278918.0
Fold 2:	 Epoch 18	TRAIN LOSS: 0.5050	VALID AUC: 0.7053	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2157
token_cnts 2348419 label_sums 1349969.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2472020 label_sums 1421020.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.74it/s]
token_cnts 2595621 label_sums 1492071.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.92it/s]
token_cnts 2719222 label_sums 1563122.0
Fold 2:	 Epoch 22	TRAIN LOSS: 0.4831	VALID AUC: 0.7135	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2446
token_cnts 2842823 label_sums 1634173.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2966424 label_sums 1705224.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 3090025 label_sums 1776275.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.89it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.89it/s]
token_cnts 3213626 label_sums 1847326.0
Fold 2:	 Epoch 26	TRAIN LOSS: 0.4638	VALID AUC: 0.7076	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2768
token_cnts 3337227 label_sums 1918377.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.01it/s]
token_cnts 3460828 label_sums 1989428.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 3584429 label_sums 2060479.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.96it/s]
token_cnts 3708030 label_sums 2131530.0
Fold 2:	 Epoch 30	TRAIN LOSS: 0.4410	VALID AUC: 0.7213	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3368
token_cnts 3831631 label_sums 2202581.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 3955232 label_sums 2273632.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 4078833 label_sums 2344683.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.72it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.72it/s]
token_cnts 4202434 label_sums 2415734.0
Fold 2:	 Epoch 34	TRAIN LOSS: 0.4403	VALID AUC: 0.7113	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3809
token_cnts 4326035 label_sums 2486785.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.03it/s]
token_cnts 4449636 label_sums 2557836.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 4573237 label_sums 2628887.0
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
 75%|███████████████████████████████████████████████████████████████████████████████████████▊                             | 6/8 [00:01<00:00,  4.95it/s]
token_cnts 4696838 label_sums 2699938.0
Fold 2:	 Epoch 38	TRAIN LOSS: 0.4298	VALID AUC: 0.7092	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3542
token_cnts 4820439 label_sums 2770989.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 4944040 label_sums 2842040.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 5067641 label_sums 2913091.0
[ORIGINAL] Best Model	TEST AUC: 0.7209	TEST ACC: 0.6751	TEST RMSE: 0.4679
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10972.79
auc 0.7209 acc 0.6751 rmse 0.4679
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:71.60
mean of total set, question correct ratio:69.62
mean of total set, class 0 ratio:0.43
mean of total set, class 1 ratio:0.57
--------------------------------------------------------------------------------
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
# of train set, 3600
mean of train set, skill correct ratio:71.58
mean of train set, question correct ratio:69.62
mean of train set, class 0 ratio:0.43
mean of train set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:71.58
mean of valid set, question correct ratio:69.62
mean of valid set, class 0 ratio:0.42
mean of valid set, class 1 ratio:0.58
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:71.58
mean of test set, question correct ratio:69.62
mean of test set, class 0 ratio:0.42
mean of test set, class 1 ratio:0.58
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 2
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
token_cnts 122834 label_sums 70478.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 245668 label_sums 140956.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.84it/s]
token_cnts 368502 label_sums 211434.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.67it/s]
token_cnts 491336 label_sums 281912.0
Fold 3:	 Epoch 4	TRAIN LOSS: 0.6630	VALID AUC: 0.6482	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.4489
token_cnts 614170 label_sums 352390.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 737004 label_sums 422868.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 859838 label_sums 493346.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 982672 label_sums 563824.0
Fold 3:	 Epoch 8	TRAIN LOSS: 0.6196	VALID AUC: 0.6886	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2161
token_cnts 1105506 label_sums 634302.0
Fold 3:	 Epoch 9	TRAIN LOSS: 0.6121	VALID AUC: 0.6920	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2027
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 1228340 label_sums 704780.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 1351174 label_sums 775258.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 1474008 label_sums 845736.0
Fold 3:	 Epoch 12	TRAIN LOSS: 0.5737	VALID AUC: 0.7061	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1555
token_cnts 1596842 label_sums 916214.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 1719676 label_sums 986692.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 1842510 label_sums 1057170.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 1965344 label_sums 1127648.0
Fold 3:	 Epoch 16	TRAIN LOSS: 0.5216	VALID AUC: 0.6996	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2930
token_cnts 2088178 label_sums 1198126.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 2211012 label_sums 1268604.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 2333846 label_sums 1339082.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 2456680 label_sums 1409560.0
Fold 3:	 Epoch 20	TRAIN LOSS: 0.4922	VALID AUC: 0.7210	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3023
token_cnts 2579514 label_sums 1480038.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 2702348 label_sums 1550516.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.85it/s]
token_cnts 2825182 label_sums 1620994.0
Fold 3:	 Epoch 23	TRAIN LOSS: 0.4783	VALID AUC: 0.7105	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2590
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 3:	 Epoch 24	TRAIN LOSS: 0.4649	VALID AUC: 0.7181	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2739
token_cnts 3070850 label_sums 1761950.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 3193684 label_sums 1832428.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 3316518 label_sums 1902906.0
Fold 3:	 Epoch 27	TRAIN LOSS: 0.4598	VALID AUC: 0.7054	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3103
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 3:	 Epoch 28	TRAIN LOSS: 0.4506	VALID AUC: 0.7234	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3157
token_cnts 3562186 label_sums 2043862.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 3685020 label_sums 2114340.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 3807854 label_sums 2184818.0
Fold 3:	 Epoch 31	TRAIN LOSS: 0.4408	VALID AUC: 0.7218	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3317
token_cnts 3930688 label_sums 2255296.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 4053522 label_sums 2325774.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 4176356 label_sums 2396252.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 4299190 label_sums 2466730.0
Fold 3:	 Epoch 35	TRAIN LOSS: 0.4188	VALID AUC: 0.7193	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3681
token_cnts 4422024 label_sums 2537208.0
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
 12%|██████████████▋                                                                                                      | 1/8 [00:00<00:01,  4.02it/s]
token_cnts 4544858 label_sums 2607686.0
[ORIGINAL] Best Model	TEST AUC: 0.7246	TEST ACC: 0.6737	TEST RMSE: 0.4667
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
[INFERENCE SPEED] Samples/second: 10986.50
auc 0.7246 acc 0.6737 rmse 0.4667
--------------------------------------------------------------------------------
mean of total set, skill correct ratio:71.60
mean of total set, question correct ratio:69.62
mean of total set, class 0 ratio:0.43
mean of total set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of train set, 3600
mean of train set, skill correct ratio:71.60
mean of train set, question correct ratio:69.66
mean of train set, class 0 ratio:0.43
mean of train set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of valid set, 400
mean of valid set, skill correct ratio:71.60
mean of valid set, question correct ratio:69.66
mean of valid set, class 0 ratio:0.43
mean of valid set, class 1 ratio:0.57
--------------------------------------------------------------------------------
# of test set, 1000
mean of test set, skill correct ratio:71.60
mean of test set, question correct ratio:69.66
mean of test set, class 0 ratio:0.43
mean of test set, class 1 ratio:0.57
--------------------------------------------------------------------------------
train_ids 3600
valid_ids 400
test_ids 1000
batch_size: 512
describe: default
diff_as_loss_weight: False
diff_order: random
eval_batch_size: 512
gpu_num: 0
l2: 0.0
learning_rate: 0.001
log_path: logs
log_wandb_fold: True
loss: BCE
max_grad_norm: 2.0
num_epochs: 300
optimizer: adam
print_epochs: 1
save_epochs: 1
save_model: False
save_model_name: tmp
seed: 12405
seq_len: 100
sequence_option: recent
server_num: 0
uniform: False
valid_balanced: False
balance_loss_weight: 0.001
d_ff: 1024
dropout: 0.05
embedding_size: 64
final_fc_dim: 512
kq_same: True
l2: 0.1
model_type: routerakt
num_alibi_heads: 0
num_attn_heads: 8
num_blocks: 2
num_selected_heads: 2
num_shared_heads: 1
routing_mode: dynamic
separate_qr: False
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 124397 label_sums 71491.0
Fold 4:	 Epoch 1	TRAIN LOSS: 0.7235	VALID AUC: 0.6331	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3547
token_cnts 248794 label_sums 142982.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 373191 label_sums 214473.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 497588 label_sums 285964.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 621985 label_sums 357455.0
Fold 4:	 Epoch 5	TRAIN LOSS: 0.6458	VALID AUC: 0.6716	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3324
token_cnts 746382 label_sums 428946.0
Fold 4:	 Epoch 6	TRAIN LOSS: 0.6355	VALID AUC: 0.6782	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.1927
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 870779 label_sums 500437.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.76it/s]
token_cnts 995176 label_sums 571928.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 1119573 label_sums 643419.0
Fold 4:	 Epoch 9	TRAIN LOSS: 0.6086	VALID AUC: 0.6924	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.0658
token_cnts 1243970 label_sums 714910.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.35it/s]
token_cnts 1368367 label_sums 786401.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.77it/s]
token_cnts 1492764 label_sums 857892.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 1617161 label_sums 929383.0
Fold 4:	 Epoch 13	TRAIN LOSS: 0.5526	VALID AUC: 0.7148	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3565
token_cnts 1741558 label_sums 1000874.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 1865955 label_sums 1072365.0
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
 38%|███████████████████████████████████████████▉                                                                         | 3/8 [00:00<00:01,  4.75it/s]
token_cnts 1990352 label_sums 1143856.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 2114749 label_sums 1215347.0
Fold 4:	 Epoch 17	TRAIN LOSS: 0.5215	VALID AUC: 0.7061	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3264
token_cnts 2239146 label_sums 1286838.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 2363543 label_sums 1358329.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.87it/s]
token_cnts 2487940 label_sums 1429820.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 2612337 label_sums 1501311.0
Fold 4:	 Epoch 21	TRAIN LOSS: 0.4886	VALID AUC: 0.7171	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2569
token_cnts 2736734 label_sums 1572802.0
Fold 4:	 Epoch 22	TRAIN LOSS: 0.4836	VALID AUC: 0.7236	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2604
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 2861131 label_sums 1644293.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.88it/s]
token_cnts 2985528 label_sums 1715784.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 3109925 label_sums 1787275.0
Fold 4:	 Epoch 25	TRAIN LOSS: 0.4693	VALID AUC: 0.7268	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2718
token_cnts 3234322 label_sums 1858766.0
Fold 4:	 Epoch 26	TRAIN LOSS: 0.4632	VALID AUC: 0.7205	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2581
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 3358719 label_sums 1930257.0
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
 50%|██████████████████████████████████████████████████████████▌                                                          | 4/8 [00:00<00:00,  4.86it/s]
token_cnts 3483116 label_sums 2001748.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 3607513 label_sums 2073239.0
Fold 4:	 Epoch 29	TRAIN LOSS: 0.4681	VALID AUC: 0.7159	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3376
token_cnts 3731910 label_sums 2144730.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 3856307 label_sums 2216221.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 3980704 label_sums 2287712.0
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
token_cnts 4105101 label_sums 2359203.0
Fold 4:	 Epoch 33	TRAIN LOSS: 0.4458	VALID AUC: 0.7237	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3522
token_cnts 4229498 label_sums 2430694.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.70it/s]
token_cnts 4353895 label_sums 2502185.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.91it/s]
token_cnts 4478292 label_sums 2573676.0
Fold 4:	 Epoch 36	TRAIN LOSS: 0.4401	VALID AUC: 0.7108	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3603
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 4:	 Epoch 37	TRAIN LOSS: 0.4423	VALID AUC: 0.7134	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3941
token_cnts 4727086 label_sums 2716658.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.68it/s]
token_cnts 4851483 label_sums 2788149.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 4975880 label_sums 2859640.0
Fold 4:	 Epoch 40	TRAIN LOSS: 0.4299	VALID AUC: 0.7190	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3443
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
  0%|                                                                                                                             | 0/8 [00:00<?, ?it/s]
Fold 4:	 Epoch 41	TRAIN LOSS: 0.4311	VALID AUC: 0.7252	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.2925
token_cnts 5224674 label_sums 3002622.0
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
token_cnts 5349071 label_sums 3074113.0
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
 62%|█████████████████████████████████████████████████████████████████████████▏                                           | 5/8 [00:01<00:00,  4.93it/s]
token_cnts 5473468 label_sums 3145604.0
Fold 4:	 Epoch 44	TRAIN LOSS: 0.4272	VALID AUC: 0.7253	VALID AUC(Balanced): 0.0000	BALANCE LOSS: 1.3347
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:01<00:00,  5.69it/s]
[ORIGINAL] Best Model	TEST AUC: 0.7215	TEST ACC: 0.6785	TEST RMSE: 0.4664
[DEBUG] Head weights data available for routerakt
[DEBUG] Skipping attention maps visualization for routerakt
[DEBUG] attention_maps_data: Available
[DEBUG] use_wandb: 1
[DEBUG] disable_visualization: 1
Warming up GPU and model caches...
Measuring inference speed...
[INFERENCE SPEED] Samples/second: 10976.49
auc 0.7215 acc 0.6785 rmse 0.4664
Average Inference Speed: 10980.55 samples/second (±5.44)